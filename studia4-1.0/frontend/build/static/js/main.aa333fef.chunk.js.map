{"version":3,"sources":["Remote.js","Register.js","Schedule.js","Login.js","Nav.js","Courses.js","Grades.js","ReschedRequests.js","Polls.js","News.js","Workers.js","AdminSchedule.js","App.js","reportWebVitals.js","index.js"],"names":["useRemoteData","fetcher","React","useState","data","setData","refresh","useCallback","then","catch","alert","useEffect","username","passowrd","a","loginData","FormData","append","fetch","document","location","host","method","body","status","res","json","fetchCourses","fetchClasses","url","URL","searchParams","console","log","classes","schedObj","forEach","name","id","roomNumber","class_type","timeSlotID","room","type","slot","fetchRatings","pushRescheduleRequest","changes","ratings","Promise","resolve","setTimeout","reject","ok","slots","Array","from","poll","pollID","pollName","sbjId","fetchCoursesRegister","slotRts","rObj","s","slotId","rating","rts","Object","keys","values","fetchGrades","user","grade","fetchRequests","cls","Math","floor","random","stud","to","fetchPolls","polls","map","fetchGroups","groups","grp","slt","fetchGroupSchedule","fetchNews","title","text","fetchWorkers","Register","allSubjects","mySubjects","schedule","usePopup","popup","show","currSubjects","setSubjects","registeredSubjects","useMemo","subjects","retSet","Set","sbj","add","sbjSet","fwd","className","SearchBar","onSearch","srch","filter","sub","includes","Button","onClick","SubjectRegister","alReg","has","undefined","style","backgroundColor","getColor","evalSlots","h","initSchedule","initSelections","mode","onSelect","classRegister","verifyClose","subjectRegister","ratingVals","r","sort","reverse","genWeights","length","w","i","reduce","r1","r2","prop","val","len","min","hours","days","schedStateReducer","state","action","dragged","x","y","newSched","entries","dropSlots","current","clb","JSON","parse","stringify","resched","selections","Schedule","initRatings","disabledSlots","actions","permResched","setDataPusher","useRef","registerDropSlot","cb","unsub","borderRef","useReducer","dispatch","schedBySlot","perm","disId","sbs","push","pend","transformSchedule","getCbData","reschedule","inital","scheduleDiff","select","sel","reduceSelections","rate","ref","HourLegend","day","hour","indexOf","toString","getSlotId","ClassBox","selected","droppable","drops","disabled","elem","act","btProps","rect","getBoundingClientRect","top","bottom","left","right","cont","Rater","Class","Collision","handlers","clsName","concat","props","width","prevW","setText","useLayoutEffect","newText","split","l","tId","clearTimeout","onMouseDown","event","preventDefault","currentTarget","offset","window","scrollX","pageX","scrollY","pageY","DraggedClass","initPos","alts","opacity","ox","oy","pos","setPos","handleMove","addEventListener","removeEventListener","useMousePos","height","borderTop","borderLeft","borderBottom","borderRight","leftPos","max","topPos","onMouseUp","clss","eqWidth","ufWidth","focused","setFocused","onMove","mx","clientX","my","clientY","onMouseLeave","onMouseEnter","maxWidth","clsExpanded","setExpanded","textShadow","clsElem","maxHeight","e","ScheduleView","setSchedule","setRatings","setMode","schedProps","chng","rtings","pushRatings","LogIn","useContext","DispatchContext","nameVal","setName","passVal","setPass","onSubmit","login","un","value","onChange","target","required","placeholder","submit","LogInLink","UserContext","float","NavLink","children","view","nNots","ShowNav","toggle","NavBar","links","windWidth","sideVisible","setSide","prompt","display","link","stack","prev","getCourseText","CourseInfo","info","setInfo","MaitainerInfo","Course","expanded","maitainerName","CoursesList","courses","crs","Grades","ReschedRequests","requests","setRequests","delRequest","reqs","req","RRequest","del","pending","setPending","approveRequest","declineRequest","Polls","position","setPolls","resolvePoll","best","s1","s2","vote","fetchPollSlots","handleData","rtngs","votePoll","GroupSelector","grps","fetchIntersect","SlotSelector","initSlots","addPoll","newPoll","pls","err","remove","removePoll","p","Poll","voted","crtBtRef","expSelect","fullSel","expandSelection","expandedSlots","schedDataGetter","marginBottom","focus","getter","form","News","infos","Workers","workers","suggestions","searched","setSearched","worker","setWorker","str","fetchWorkerInfo","AdminSchedule","filteredClasses","setClasses","setGroups","createContext","stateReducer","innerWidth","content","App","updateWidth","security","Provider","ContentBox","Footer","forwardRef","autofocus","clicked","setClicked","searchOnSelect","searchVal","setVal","focusedSugg","setFocusedSugg","showSugg","setShowSugg","fltrSuggerstions","sug","autoComplete","onFocus","onBlur","onKeyDown","key","rejector","currElem","setElem","elemGetter","close","buttonRef","allGroups","groupNames","gr","newGroups","g","cp","splice","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"2XAGO,SAASA,EAAcC,GAC1B,MAAwBC,IAAMC,SAAS,MAAvC,mBAAOC,EAAP,KAAaC,EAAb,KACMC,EAAUJ,IAAMK,aAAY,kBAAMN,IAAUO,KAAKH,GAASI,MAAMC,SAAQ,CAACT,IAE/E,OADAC,IAAMS,UAAUL,EAAS,CAACA,IACnB,CAACF,EAAME,EAASD,G,4CAGpB,WAAqBO,EAAUC,GAA/B,eAAAC,EAAA,mFAIGC,EAAY,IAAIC,UACZC,OAAO,WAAYL,GAC7BG,EAAUE,OAAO,WAAYJ,GAN1B,SAOoBK,MAAM,UAAYC,SAASC,SAASC,KAAO,SAAU,CAACC,OAAQ,OAAQC,KAAMR,IAPhG,UAQqB,MARrB,OAQUS,OARV,sBASO,eATP,yBAWUN,MAAM,UAAYC,SAASC,SAASC,KAAO,WACnDb,MAAK,SAAAiB,GAAG,OAAIA,EAAIC,UAAQjB,MAAMC,OAZhC,sF,sBAeA,SAAeiB,IAAtB,+B,4CAAO,sBAAAb,EAAA,4FAaUI,MAAM,UAAYC,SAASC,SAASC,KAAO,YAAYb,MAAK,SAAAiB,GAAG,OAAIA,EAAIC,UAbjF,oF,sBAgBA,SAAeE,IAAtB,+B,4CAAO,gCAAAd,EAAA,mFAqCGe,EAAM,IAAIC,IAAI,UAAYX,SAASC,SAASC,KAAO,aACrDU,aAAad,OAAO,OAAQ,QAChCe,QAAQC,IAAI,sBAvCT,SAwCmBf,MAAMW,GAAKrB,MAAK,SAAAiB,GAAG,OAAIA,EAAIC,UAxC9C,cAwCGQ,EAxCH,OAyCHF,QAAQC,IAAI,oBACZD,QAAQC,IAAIC,GACNC,EAAW,GACjBD,EAAQE,SAAQ,gBAAGC,EAAH,EAAGA,KAAMC,EAAT,EAASA,GAAIC,EAAb,EAAaA,WAAYC,EAAzB,EAAyBA,WAAYC,EAArC,EAAqCA,WAArC,OAAsDN,EAASG,GAAM,CACjFD,OACAC,KACAI,KAAMH,EACNI,KAAMH,EACNI,KAAMH,MAEVT,QAAQC,IAAI,yBACZD,QAAQC,IAAIE,GApDT,kBAqDIA,GArDJ,6C,sBAwDA,SAAeU,IAAtB,+B,4CAAO,sBAAA/B,EAAA,+EAIK,CACJ,EAAK,EACL,GAAM,EACN,EAAK,IAPN,4C,sBAWA,SAAegC,EAAtB,kC,4CAAO,WAAqCC,GAArC,SAAAjC,EAAA,6DACHkB,QAAQC,IAAIc,GADT,mBAEI,GAFJ,4C,kEAKA,WAA2BC,GAA3B,SAAAlC,EAAA,6DACHkB,QAAQC,IAAIe,GADT,mBAEI,GAFJ,4C,kEAKA,WAA8BV,GAA9B,SAAAxB,EAAA,6DACHkB,QAAQC,IAAIK,GADT,kBAEI,IAAIW,SAAQ,SAAAC,GAAO,OAAIC,YAAW,kBAAMD,GAAQ,KAAO,SAF3D,4C,kEAKA,WAA8BZ,GAA9B,SAAAxB,EAAA,6DACHkB,QAAQC,IAAIK,GADT,kBAEI,IAAIW,SAAQ,SAACC,EAASE,GAAV,OAAqBD,YAAW,kBAAMC,EAAO,SAAQ,SAFrE,4C,kEAKA,WAA0Bd,GAA1B,eAAAxB,EAAA,mFAIGV,EAAO,IAAIY,UACZC,OAAO,SAAUqB,GALnB,SAMepB,MAAM,UAAYC,SAASC,SAASC,KAAO,eAAgB,CAACC,OAAQ,OAAQC,KAAMnB,IANjG,iBAOMiD,GAPN,qBAQO,cARP,iCAUI,GAVJ,6C,kEAaA,WAAuBhB,EAAMiB,GAA7B,mBAAAxC,EAAA,mFAOGV,EAAO,IAAIY,UACZC,OAAO,OAAQoB,GACpBjC,EAAKa,OAAO,QAASsC,MAAMC,KAAKF,IAT7B,SAUepC,MAAM,UAAYC,SAASC,SAASC,KAAO,YAAa,CAACC,OAAQ,OAAQC,KAAMnB,IAV9F,WAUGqB,EAVH,QAWM4B,GAXN,sBAYO,YAZP,yBAcgB5B,EAAIC,OAdpB,eAcG+B,EAdH,yBAeI,CAACnB,GAAImB,EAAKC,OAAQrB,KAAMoB,EAAKE,WAfjC,6C,kEAkBA,WAA+BrB,GAA/B,SAAAxB,EAAA,gFACI,GADJ,4C,kEAIA,WAA6B8C,EAAOhB,GAApC,SAAA9B,EAAA,gFACI,GADJ,4C,sBAIA,SAAe+C,IAAtB,+B,4CAAO,sBAAA/C,EAAA,+EACI,CAAC,CACJuB,KAAM,MACNC,GAAI,KAER,CACID,KAAM,MACNC,GAAI,IACJgB,MAAO,CAAC,EAAG,EAAG,IAElB,CACIjB,KAAM,MACNC,GAAI,KAER,CACID,KAAM,OACNC,GAAI,OAhBL,4C,kEAoBA,WAA2BA,GAA3B,qBAAAxB,EAAA,mFAOGe,EAAM,IAAIC,IAAI,UAAYX,SAASC,SAASC,KAAO,iBACrDU,aAAad,OAAO,SAAUqB,GAR/B,SASepB,MAAMW,GATrB,cASGJ,EATH,gBAUmBA,EAAIC,OAVvB,cAUGoC,EAVH,OAWGC,EAAO,GACbD,EAAQ1B,SAAQ,SAAA4B,GAAC,OAAID,EAAKC,EAAEC,QAAUD,EAAEE,UAZrC,kBAaIJ,GAbJ,6C,kEAgBA,WAAwBxB,EAAI6B,GAA5B,iBAAArD,EAAA,mFAIGV,EAAO,IAAIY,UACZC,OAAO,SAAUqB,GACtBlC,EAAKa,OAAO,UAAWmD,OAAOC,KAAKF,IACnC/D,EAAKa,OAAO,UAAWmD,OAAOE,OAAOH,IAPlC,SAQejD,MAAM,UAAYC,SAASC,SAASC,KAAO,aAAc,CAACC,OAAQ,OAAQC,KAAMnB,IAR/F,cAQGqB,EARH,OASHO,QAAQC,IAAIR,EAAID,QATb,kBAUIC,EAAID,QAVR,6C,sBAaA,SAAe+C,EAAtB,kC,4CAAO,WAA2BC,GAA3B,SAAA1D,EAAA,+EACK,CAAC,CACLuB,KAAM,MACNoC,MAAO,GAEX,CACIpC,KAAM,MACNoC,OAAQ,MAPT,4C,sBAYA,SAAeC,EAAtB,kC,4CAAO,WAA6BF,GAA7B,SAAA1D,EAAA,+EACK,CAAC,CACLwB,GAAI,IACJqC,IAAK,CACDtC,KAAM,MACNM,KAAM,CAAC,eAAgB,YAAa,UAAUiC,KAAKC,MAAoB,EAAdD,KAAKE,YAElEC,KAAM,WACNC,GAAI,KAER,CACI1C,GAAI,IACJqC,IAAK,CACDtC,KAAM,MACNM,KAAM,CAAC,eAAgB,YAAa,UAAUiC,KAAKC,MAAoB,EAAdD,KAAKE,YAElEC,KAAM,UACNC,GAAI,QAjBL,4C,sBAsBA,SAAeC,IAAtB,+B,4CAAO,8BAAAnE,EAAA,4FAYeI,MAAM,UAAYC,SAASC,SAASC,KAAO,UAZ1D,cAYGI,EAZH,gBAaiBA,EAAIC,OAbrB,cAaGwD,EAbH,OAcHlD,QAAQC,IAAIiD,GAdT,kBAeIA,EAAMC,KAAI,kBAA2B,CAAC9C,KAA5B,EAAGsB,SAAyCrB,GAA5C,EAAaoB,YAf3B,6C,sBAkBA,SAAe0B,IAAtB,+B,4CAAO,8BAAAtE,EAAA,mFAgBGe,EAAM,IAAIC,IAAI,UAAYX,SAASC,SAASC,KAAO,aACrDU,aAAad,OAAO,OAAQ,OAjB7B,SAkBeC,MAAMW,GAlBrB,cAkBGJ,EAlBH,gBAmBUA,EAAIC,OAnBd,qF,kEAsBA,WAA8B2D,GAA9B,mBAAAvE,EAAA,mFAOGV,EAAO,IAAIY,UACZC,OAAO,WAAYoE,EAAOF,KAAI,SAAAG,GAAG,OAAIA,EAAIhD,OAR3C,SASepB,MAAM,UAAYC,SAASC,SAASC,KAAO,aAAc,CAACC,OAAQ,OAAQC,KAAMnB,IAT/F,cASGqB,EATH,OAUG6B,EAAQ,GAVX,UAWI7B,EAAIC,OAXR,sBAWgBU,SAAQ,SAAAmD,GAAG,OAAIjC,EAAMiC,IAAO,KAX5C,kBAYIjC,GAZJ,6C,sBAeA,SAAekC,EAAtB,kC,4CAAO,WAAkCH,GAAlC,SAAAvE,EAAA,+EACI,CACH,EAAG,CACCuB,KAAM,MACNO,KAAM,IACNF,KAAM,KACNJ,GAAI,IACJK,KAAM,CAAC,eAAgB,YAAa,UAAUiC,KAAKC,MAAoB,EAAdD,KAAKE,YAElE,EAAG,CACCzC,KAAM,KACNO,KAAM,IACNF,KAAM,KACNJ,GAAI,IACJK,KAAM,CAAC,eAAgB,YAAa,UAAUiC,KAAKC,MAAoB,EAAdD,KAAKE,YAElE,EAAG,CACCzC,KAAM,MACNO,KAAM,IACNF,KAAM,KACNJ,GAAI,IACJK,KAAM,CAAC,eAAgB,YAAa,UAAUiC,KAAKC,MAAoB,EAAdD,KAAKE,YAElE,EAAG,CACCzC,KAAM,MACNO,KAAM,KACNF,KAAM,KACNJ,GAAI,IACJK,KAAM,kBA5BX,4C,kEAiCA,WAA8BL,GAA9B,SAAAxB,EAAA,+EACI,CAAC,EAAK,EAAG,GAAM,IADnB,4C,sBAIA,SAAe2E,IAAtB,+B,4CAAO,sBAAA3E,EAAA,+EACI,CACH,CACI4E,MAAO,WACPC,KAAM,0CAEV,CACID,MAAO,MACPC,KAAM,mDARX,4C,sBAaA,SAAeC,IAAtB,+B,4CAAO,sBAAA9E,EAAA,+EACI,CACH,CACIuB,KAAM,SACNC,GAAI,KAER,CACID,KAAM,eACNC,GAAI,OART,4C,kEAaA,WAA+BA,GAA/B,SAAAxB,EAAA,+EACI,CACH6E,KAAM,uCAFP,4C,uCC1WQ,SAASE,IACpB,MAAsB7F,EAAc6D,GAA7BiC,EAAP,oBACA,EAAqB9F,EAAc2B,GAA5BoE,EAAP,oBACA,EAAmB/F,EAAc4B,GAA1BoE,EAAP,oBACA,EAAkBhG,EAAc6C,GAAzBG,EAAP,oBACA,EAAsBiD,KAAtB,mBAAOC,EAAP,KAAcC,EAAd,KACA,EAAoCjG,IAAMC,SAAS,MAAnD,mBAAOiG,EAAP,KAAqBC,EAArB,KACMC,EAAqBpG,IAAMqG,SAAQ,kBAgE7C,SAAgBC,GACZ,GAAiB,OAAbA,EACA,OAAO,KAEX,IAAMC,EAAS,IAAIC,IAEnB,OADAF,EAASpE,SAAQ,SAAAuE,GAAG,OAAIF,EAAOG,IAAID,EAAIrE,OAChCmE,EAtEwCI,CAAOd,KAAa,CAACA,IACpE,GAAoB,OAAhBD,GAA+C,OAAvBQ,GAA2C,OAAZtD,EACvD,OAAO,sDAEX,IAAM8D,EAAM,CAACX,OAAMH,WAAUhD,WACvBwD,EAAQ,OAAGJ,QAAH,IAAGA,IAAgBN,EACjC,OACI,sBAAKiB,UAAU,cAAf,UACI,cAACC,GAAD,CAAWC,SAAU,SAAAC,GAAI,OAAIb,EAAYP,EAAYqB,QAAO,SAAAC,GAAG,OAAIA,EAAI/E,KAAKgF,SAASH,UACnE,OAAjBd,GAAyB,cAACkB,GAAD,CAAQC,QAAS,kBAAMlB,EAAY,OAAnC,+BACzBG,EAASrB,KAAI,SAAAwB,GAAG,OAAI,cAACa,GAAD,aAAiBb,IAAKA,EAAKc,MAAOnB,EAAmBoB,IAAIf,EAAIrE,KAASwE,OAC1FZ,KAKb,SAASsB,GAAT,GAAmE,IAAxCb,EAAuC,EAAvCA,IAAK3D,EAAkC,EAAlCA,QAASyE,EAAyB,EAAzBA,MAAOtB,EAAkB,EAAlBA,KAAMH,EAAY,EAAZA,SAC5C1C,EAAQpD,IAAMqG,SAAQ,WACxB,QAAkBoB,IAAdhB,EAAIrD,MAAR,CAGA,IAAMA,EAAQ,GAEd,OADAqD,EAAIrD,MAAMlB,SAAQ,SAAAmD,GAAG,OAAIjC,EAAMiC,IAAO,KAC/BjC,KACR,CAACqD,IACJ,OACI,sBAAKI,UAAU,UAAf,UACKJ,EAAItE,KAEL,sBAAM0E,UAAU,kBAAhB,SAAmCU,EAAQ,iBAAmB,qCACzDnE,GAAS,qBAAKyD,UAAU,YAAYa,MAAO,CAACC,gBAAiBC,GAASC,GAAUpB,EAAIrD,MAAON,OAC5F,cAACsE,GAAD,CAAQC,QAAS,WACTjE,EACA6C,GAAK,SAAA6B,GAAC,OAAI,cAAC,GAAD,CACNC,aAAcjC,EACdkC,eAAgB5E,EAChB6E,KAAM,SACNC,SAAUJ,OACVxH,MAAK,SAAAoC,GAAI,ODgH9B,SAAP,oCChHyCyF,CAAc1B,EAAIrE,GAAIM,KAAO0F,ID4G/D,SAAP,2BC1GwBC,CAAgB5B,EAAIrE,KAT5B,iCAiBhB,SAASyF,GAAUzE,EAAON,GACtB,IAAMwF,EAAalF,EAAM6B,KAAI,SAAAnB,GAAC,OAAIhB,EAAQgB,MAAImD,QAAO,SAAAsB,GAAC,YAAUd,IAANc,KAAiBC,OAAOC,UAClF,OAAOC,GAAW,GAAK,EAAGJ,EAAWK,QAAQ1D,KAAI,SAAC2D,EAAGC,GAAJ,OAAUD,EAAEN,EAAWO,MAAIC,QAAO,SAACC,EAAIC,GAAL,OAAYD,EAAGC,KAAM,EAG5G,SAASN,GAAWO,EAAMC,EAAKC,GAC3B,OAAY,IAARA,EACO,GAEL,CAAED,EAAID,GAAZ,mBAAqBP,GAAWO,EAAMC,GAAK,EAAED,GAAOE,EAAM,KAGvD,SAASvB,GAASsB,GACrB,MAAM,OAAN,OAAcxE,KAAKC,MAAMD,KAAK0E,IAAI,IAAa,KAAP,EAAEF,KAA1C,aAAyDxE,KAAKC,MAAMD,KAAK0E,IAAI,IAAS,IAAJF,IAAlF,QCrEJ,IAAMG,GAAQ,CAAC,OAAQ,QAAS,QAAS,QAAS,QAAS,SACrDC,GAAO,CAAC,eAAgB,SAAU,QAAS,WAAY,UAqB7D,SAASC,GAAkBC,EAA3B,GAAqD,IAAD,EAAhBC,EAAgB,EAAhBA,OAAQvJ,EAAQ,EAARA,KACxC,OAAQuJ,GACJ,IAAK,OACD,OAAO,2BAAID,GAAX,IAAkBE,QAASxJ,IAC/B,IAAK,UAGD,IAFA,IAAQyJ,EAAazJ,EAAbyJ,EAAGC,EAAU1J,EAAV0J,EAAGxH,EAAOlC,EAAPkC,GACVyH,EAAW,KACf,MAA0B3F,OAAO4F,QAAQN,EAAMO,UAAUC,SAAzD,eAAmE,CAA9D,0BAAOtH,EAAP,KACD,IAAIuH,EADH,MACON,EAAGC,GAAI,EACXC,EAAWK,KAAKC,MAAMD,KAAKE,UAAUZ,EAAM1D,YAClC1D,GAAIiI,QAAU3H,EACnBmH,EAASzH,GAAIM,OAASA,UACfmH,EAASzH,GAAIiI,QAExB,OAGR,OAAO,2BAAIb,GAAX,IAAkBE,QAAS,KAAM5D,SAAQ,UAAE+D,SAAF,QAAcL,EAAM1D,WACjE,IAAK,eACD,OAAO,2BAAI0D,GAAX,IAAkBc,WAAW,2BAAKd,EAAMc,YAAZ,kBAAyBpK,GAAQsJ,EAAMc,WAAWpK,OAClF,IAAK,SACD,OAAO,2BAAIsJ,GAAX,IAAkB1G,QAAQ,2BAAK0G,EAAM1G,SAAZ,kBAAsB5C,EAAKwC,KAAOxC,EAAK8D,WACpE,IAAK,cACD,OAAO,2BAAIwF,GAAX,IAAkB1D,SAAU5F,IAChC,IAAK,gBACD,OAAO,2BAAIsJ,GAAX,IAAkBc,WAAYpK,IAClC,IAAK,aACD,OAAO,2BAAIsJ,GAAX,IAAkB1G,QAAS5C,IAC/B,QACI,OAAOsJ,GAwCZ,SAASe,GAAT,GAA6I,IAAzHxC,EAAwH,EAAxHA,aAAcyC,EAA0G,EAA1GA,YAAaxC,EAA6F,EAA7FA,eAAgBE,EAA6E,EAA7EA,SAAUuC,EAAmE,EAAnEA,cAAexC,EAAoD,EAApDA,KAAMyC,EAA8C,EAA9CA,QAASC,EAAqC,EAArCA,YAAaC,EAAwB,EAAxBA,cAAepF,EAAS,EAATA,MAChIuE,EAAY/J,IAAM6K,OAAO,IACzBC,EAAmB9K,IAAMK,aAAY,SAACqC,EAAMqI,EAAIC,GAAX,OAAqBA,SAAgBjB,EAAUC,QAAQtH,GAAUqH,EAAUC,QAAQtH,GAAQqI,IAAK,IACrIE,EAAYjL,IAAM6K,SACxB,EAA+D7K,IAAMkL,WAAW3B,GAAmB,CAC/FzD,SAAUiC,EACVuC,WAAYtC,EACZlF,QAAS0H,EACTd,QAAS,KACTK,cALJ,0BAASjE,EAAT,EAASA,SAAUwE,EAAnB,EAAmBA,WAAYxH,EAA/B,EAA+BA,QAAS4G,EAAxC,EAAwCA,QAAWyB,EAAnD,KAOAnL,IAAMS,WAAU,kBAAM0K,EAAS,CAAC1B,OAAQ,cAAevJ,KAAM6H,MAAgB,CAACA,IAC9E/H,IAAMS,WAAU,kBAAM0K,EAAS,CAAC1B,OAAQ,gBAAiBvJ,KAAM8H,MAAkB,CAACA,IAClFhI,IAAMS,WAAU,kBAAM0K,EAAS,CAAC1B,OAAQ,aAAcvJ,KAAMsK,MAAe,CAACA,IAC5E,IAAMY,EAAcpL,IAAMqG,SAAQ,kBAlDtC,SAA2BP,EAAUuF,EAAMC,GACvC,QAAiB7D,IAAb3B,EACA,MAAO,GAGX,IADA,IAAMyF,EAAM,GACZ,MAAwBrH,OAAO4F,QAAQhE,GAAvC,eAAkD,CAA7C,IACS,MAEH,EAEc,EALpB,sBAAO1D,EAAP,KAAWqC,EAAX,KACG4G,EACAjJ,IAAOkJ,IAAS,UAACC,EAAG,UAAC9G,EAAI4F,eAAL,QAAgB5F,EAAI/B,aAAxB,QAAkC6I,EAAG,UAAC9G,EAAI4F,eAAL,QAAgB5F,EAAI/B,MAAQ,IAAK8I,KAAK/G,KAE3F,UAAC8G,EAAI9G,EAAI/B,aAAT,QAAmB6I,EAAI9G,EAAI/B,MAAQ,IAAK8I,KAAK/G,GACzCA,EAAI4F,UACJ,UAACkB,EAAI9G,EAAI4F,gBAAT,QAAsBkB,EAAI9G,EAAI4F,SAAW,IAAKmB,KAA7C,2BAAsD/G,GAAvD,IAA4DgH,MAAM,MAI9E,OAAOF,EAmCiCG,CAAkB5F,EAAU6E,EAAX,OAAwBjB,QAAxB,IAAwBA,OAAxB,EAAwBA,EAAS4B,SAAQ,CAACxF,EAAU6E,EAAajB,IAEpH9C,EAAM,CAACqB,OAAMkD,WAAUL,mBAAkB5C,WAAU+C,aAEnDU,EAAY,CACdC,WAAY,kBA7BpB,SAAsBC,EAAQ7B,GAE1B,IADA,IAAMnH,EAAU,GAChB,MAAwBqB,OAAO4F,QAAQE,GAAvC,eAAiD,CAAC,IAAD,IAC8B,EAD1E,sBAAO5H,EAAP,KAAWqC,EAAX,MACG,UAACA,EAAI4F,eAAL,QAAgB5F,EAAI/B,SAApB,UAA+BmJ,EAAOzJ,GAAIiI,eAA1C,QAAqDwB,EAAOzJ,GAAIM,QAChEG,EAAQT,GAAR,UAAcqC,EAAI4F,eAAlB,QAA6B5F,EAAI/B,MAGzC,OAAOG,EAsBeiJ,CAAa/D,EAAcjC,IAC7CiG,OAAQ,kBAtChB,SAA0BzB,GAEtB,IADA,IAAM0B,EAAM,IAAIxF,IAChB,MAA+BtC,OAAO4F,QAAQQ,GAA9C,eAA2D,CAAtD,0BAAO5H,EAAP,WACWsJ,EAAItF,IAAIhE,GAExB,OAAOsJ,EAiCWC,CAAiB3B,IAC/B4B,KAAM,kBAAMpJ,IACdmF,GAGF,OAFAjI,IAAMS,WAAU,yBAAMmK,QAAN,IAAMA,OAAN,EAAMA,EAAgBe,MAGlC,sBAAKvJ,GAAG,WAAWyE,UAAU,cAA7B,UACKrB,EACD,qBAAKpD,GAAG,iBAAiB+J,IAAKlB,EAA9B,SACI,qBAAI7I,GAAG,UAAP,UACI,6BAAI,cAACgK,GAAD,MACH9C,GAAKrE,KAAI,SAASoH,GACf,OACI,6BAAc,qBAAIxF,UAAU,YAAd,UACTwF,EACAhD,GAAMpE,KAAI,SAASqH,GAChB,IAAM5J,EA5H1C,SAAmB2J,EAAKC,GACpB,OAAQ,EAAIjD,GAAMkD,QAAQD,GAA0B,EAAlBhD,GAAKiD,QAAQF,IAAQG,WA2HVC,CAAUJ,EAAKC,GAC5B,OAAO,cAACI,GAAD,aAEHhK,KAAMA,EACN+B,IAAK2G,EAAY1I,GACjBiK,SAAQ,OAAErC,QAAF,IAAEA,OAAF,EAAEA,EAAa5H,GACvBsB,OAAM,OAAElB,QAAF,IAAEA,OAAF,EAAEA,EAAUJ,GAClBkK,UAAWjC,EAAc,MAAH,OAAWjB,QAAX,IAAWA,OAAX,EAAWA,EAASmD,MAAM1F,SAASzE,GACzDoK,SAAQ,OAAErC,QAAF,IAAEA,OAAF,EAAEA,EAAejD,IAAI9E,IACzBkE,GAPClE,UALR2J,MAkBjB,6BAAI,cAACD,GAAD,WAzBhB,OA4BK1C,QA5BL,IA4BKA,OA5BL,EA4BKA,EAASqD,KA5Bd,OA6BKrC,QA7BL,IA6BKA,OA7BL,EA6BKA,EAASzF,KAAI,SAAC+H,EAAKnE,GAAN,aAAY,cAACzB,GAAD,qCAAqB4F,EAAIC,eAAzB,QAAoC,IAApC,IAAyC5F,QAAS,kBAAM2F,EAAIjC,GAAGY,MAA/D,SAA8EqB,EAAI7K,OAArE0G,SA8CnD,SAASuD,KACL,OACI,qBAAIvF,UAAU,aAAd,iBAEK,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IAAI5B,KAAI,SAAAqH,GAAI,OAAI,6BAAgBA,EAAKE,WAAa,OAAzBF,SAK1D,SAASI,GAAT,GAAgI,IAA5GjI,EAA2G,EAA3GA,IAAK/B,EAAsG,EAAtGA,KAAMuF,EAAgG,EAAhGA,KAAMkD,EAA0F,EAA1FA,SAAUL,EAAgF,EAAhFA,iBAAkB6B,EAA8D,EAA9DA,SAAUzE,EAAoD,EAApDA,SAAUlE,EAA0C,EAA1CA,OAAQ4I,EAAkC,EAAlCA,UAAWE,EAAuB,EAAvBA,SAAU7B,EAAa,EAAbA,UACxGkB,EAAMnM,IAAM6K,SACZjE,EAAM,CAACqB,OAAMkD,WAAUnH,SAAQiH,aACrCjL,IAAMS,WAAU,WACZ,GAAImM,EAKA,OAJA9B,EAAiBpI,GAAM,SAASiH,EAAGC,GAC/B,IAAMsD,EAAOf,EAAInC,QAAQmD,wBACzB,OAAQvD,EAAIsD,EAAKE,KAAOxD,EAAIsD,EAAKG,QAAU1D,EAAIuD,EAAKI,MAAQ3D,EAAIuD,EAAKK,SACtE,GACI,kBAAMzC,EAAiBpI,EAAM,MAAM,MAE/C,CAACA,EAAMoI,EAAkB8B,IAC5B,IAAIY,EAAO,UACI/F,IAAXzD,EACAwJ,EAAO,cAACC,GAAD,2BAAW7G,GAAX,IAAgBlE,KAAMA,EAAM+B,IAAKA,UACzBgD,IAARhD,GAAoC,IAAfA,EAAIkE,SAChC6E,EAAsB,IAAf/I,EAAIkE,OAAe,cAAC+E,GAAD,2BAAW9G,GAAX,IAAgBnC,IAAKA,EAAI,MAAQ,cAACkJ,GAAD,2BAAe/G,GAAf,IAAoBnC,IAAKA,MAExF,IAAMmJ,EAAW,GACJ,WAAT3F,QAAkCR,IAAbkF,IACrBiB,EAASvG,QAAU,WACf8D,EAAS,CAAC1B,OAAQ,eAAgBvJ,KAAMwC,IAChC,OAARwF,QAAQ,IAARA,KAAWxF,KAGnB,IAAImL,EAAU,YAMd,OALkB,IAAdjB,GAAsBD,EACtBkB,EAAUA,EAAQC,OAAOhB,EAAW,qBAAuB,cACpDA,IACPe,EAAUA,EAAQC,OAAO,mBAEtB,4CAAIjH,UAAWgH,GAAaD,GAA5B,IAAsCzB,IAAKA,EAA3C,SAAiDqB,KAG5D,SAASE,GAAMK,GAAQ,IAAD,EACZC,EAAK,UAAGD,EAAMC,aAAT,QAAkB,IAC7B,EAAmChO,IAAMC,SAAS,CAACgO,MAAO,MAA1D,0BAASxI,EAAT,EAASA,KAAMwI,EAAf,EAAeA,MAASC,EAAxB,KACAlO,IAAMmO,iBAAgB,WAClB,IAAIC,EAYJ,GAVIA,EADAJ,GAAS,GACE,qCACND,EAAMtJ,IAAItC,KAAK,uBACf4L,EAAMtJ,IAAIhC,KAAK,uBAFT,SAGAsL,EAAMtJ,IAAIjC,QAEdwL,EAAQ,GACL,mCAAGD,EAAMtJ,IAAItC,KAAKkM,MAAM,IAAIpJ,KAAI,SAAAqJ,GAAC,OAAI,qCAAGA,EAAE,+BAE1C,yCAEVN,EAAQC,EAAO,CACf,IAAMM,EAAMtL,YAAW,kBAAMiL,EAAQ,CAACzI,KAAM2I,EAASH,MAAOD,MAAS,KACrE,OAAO,kBAAMQ,aAAaD,IAE9BL,EAAQ,CAACzI,KAAM2I,EAASH,MAAOD,MAChC,CAACA,IACJ,IAAIJ,EAAW,GACI,eAAfG,EAAM9F,OACN2F,EAASa,YAAc,SAASC,GAAQ,IAAD,EACnCA,EAAMC,iBACN,IAAMzB,EAAOwB,EAAME,cAAczB,wBAC3B0B,EAAS,CACXlF,EAAGuD,EAAKvD,EAAImF,OAAOC,QAAUL,EAAMM,MACnCpF,EAAGsD,EAAKtD,EAAIkF,OAAOG,QAAUP,EAAMQ,OAEvC,UAAAnB,EAAM5C,gBAAN,cAAA4C,EAAiB,CAACtE,OAAQ,OAAQvJ,KAAM,CACpC6M,KAAM,cAACoC,GAAD,CAAc1K,IAAKsJ,EAAMtJ,IAAK2K,QAAS,CAACzF,EAAG+E,EAAMM,MAAOpF,EAAG8E,EAAMQ,OAAQL,OAAQA,EAAQ1D,SAAU4C,EAAM5C,SAAUF,UAAW8C,EAAM9C,YAC1I4B,MAAOkB,EAAMtJ,IAAI4K,KACjB/D,MAAOyC,EAAMtJ,IAAIrC,QAI7B,IAAMsF,EAAQqG,EAAMtJ,IAAIgH,KAAO,CAAC6D,QAAS,IAAO,GAChD,OAAQ,6CAAKzI,UAAWkH,EAAMtJ,IAAIhC,MAAUmL,GAApC,IAA8ClG,MAAOA,EAArD,SAA6DjC,KAGzE,SAAS0J,GAAT,GAAsF,IAAD,IAA7DC,EAA6D,EAA7DA,QAAS3K,EAAoD,EAApDA,IAAoD,IAA/CoK,OAAYU,EAAmC,EAAtC5F,EAAU6F,EAA4B,EAA/B5F,EAAQuB,EAAuB,EAAvBA,SAAUF,EAAa,EAAbA,UAC9DkB,EAAMnM,IAAM6K,SAClB,EAhRJ,SAAqBgB,GACjB,MAAsB7L,IAAMC,SAAS4L,GAArC,mBAAO4D,EAAP,KAAYC,EAAZ,KAWA,OAVA1P,IAAMS,WAAU,WACZ,SAASkP,EAAWjB,GAChBgB,EAAO,CACH/F,EAAG+E,EAAMM,MACTpF,EAAG8E,EAAMQ,QAIjB,OADAJ,OAAOc,iBAAiB,YAAaD,GAC9B,kBAAMb,OAAOe,oBAAoB,YAAaF,MACtD,IACIF,EAoQUK,CAAYV,GAArBzF,EAAR,EAAQA,EAAGC,EAAX,EAAWA,EACX,sBAA0BuC,EAAInC,eAA9B,aAA0B,EAAamD,+BAAvC,QAAkE,CAACa,MAAO,EAAG+B,OAAQ,GAA7E/B,EAAR,EAAQA,MAAO+B,EAAf,EAAeA,OACf,EAAuF9E,EAAUjB,QAAQmD,wBAA5F6C,EAAb,EAAQ5C,IAAsB6C,EAA9B,EAAwB3C,KAA0B4C,EAAlD,EAA0C7C,OAA6B8C,EAAvE,EAAgE5C,MAC1D6C,EAAU1L,KAAK0E,IAAI1E,KAAK2L,IAAI1G,EAAI4F,EAAIU,EAAanB,OAAOC,SAAUoB,EAAcrB,OAAOC,QAAUf,GACjGsC,EAAS5L,KAAK0E,IAAI1E,KAAK2L,IAAIzG,EAAI4F,EAAIQ,EAAYlB,OAAOG,SAAUiB,EAAepB,OAAOG,QAAUc,GACtG,OAAQ,qBAAKlJ,UAAU,0BAA0Ba,MAAO,CACpD4F,KAAM8C,EACNhD,IAAKkD,GACNnE,IAAKA,EAAKoE,UAAW,WACpBzO,QAAQC,IAAI,WACZ,MAAmCoK,EAAInC,QAAQmD,wBAAxCC,EAAP,EAAOA,IAAKC,EAAZ,EAAYA,OAAQC,EAApB,EAAoBA,KAAMC,EAA1B,EAA0BA,MAC1BpC,EAAS,CAAC1B,OAAQ,UAAWvJ,KAAM,CAAC0J,GAAIwD,EAAMC,GAAU,EAAG1D,GAAI2D,EAAOC,GAAS,EAAGnL,GAAIqC,EAAIrC,OANtF,SAQJ,cAACsL,GAAD,CAAOjJ,IAAKA,MAIpB,SAASkJ,GAAT,GAA8D,IAApC6C,EAAmC,EAAxC/L,IAAWwD,EAA6B,EAA7BA,KAAMkD,EAAuB,EAAvBA,SAAUF,EAAa,EAAbA,UACtCwF,EAAU,IAAID,EAAK7H,OAEnB+H,EAAU,IAAIF,EAAK7H,OAAS,GAC5BwD,EAAMnM,IAAM6K,SAClB,EAA8B7K,IAAMC,SAAS,MAA7C,mBAAO0Q,EAAP,KAAgBC,EAAhB,KAgBA,OAZA5Q,IAAMS,WAAU,WACZ,SAASoQ,EAAOnC,GACZ,IAAiBoC,EAAmBpC,EAA5BqC,QAAsBC,EAAMtC,EAAfuC,QACrB,EAAmC9E,EAAInC,QAAQmD,wBAAxCC,EAAP,EAAOA,IAAKC,EAAZ,EAAYA,OAAQC,EAApB,EAAoBA,KAAMC,EAA1B,EAA0BA,OACtByD,EAAK5D,GAAO4D,EAAK3D,GAAUyD,EAAKxD,GAAQwD,EAAKvD,IAC7CqD,EAAW,MAInB,OADA9B,OAAOc,iBAAiB,YAAaiB,GAC9B,kBAAM/B,OAAOe,oBAAoB,YAAagB,MACtD,IAGC,qBAAK1E,IAAKA,EAAKzE,MAAO,CAACqI,OAAQ,QAASmB,aAAc,kBAAMN,EAAW,OAAvE,SACKJ,EAAKvL,KAAI,SAASR,EAAKoE,GACpB,IAAMmF,EAAoB,OAAZ2C,EAAmBF,EAAW5H,IAAM8H,EAtB/C,GAsBkED,EAC/D9J,EAAM,CAACnC,MAAKuJ,QAAO/F,OAAMkD,WAAUF,aACzC,OACI,qBAAapE,UAAU,aAAasK,aAAc,kBAAMP,EAAW/H,IAAInB,MAAO,CAAC0J,SAAS,GAAD,OAAKpD,EAAL,MAAvF,SACI,cAACN,GAAD,eAAW9G,KADLiC,QAS9B,SAAS4E,GAAT,GAAkE,IAAjDtC,EAAgD,EAAhDA,SAAUzI,EAAsC,EAAtCA,KAAMsB,EAAgC,EAAhCA,OAAQiE,EAAwB,EAAxBA,KAAMxD,EAAkB,EAAlBA,IAAKwG,EAAa,EAAbA,UAChD,EAAmCjL,IAAMC,UAAS,GAAlD,mBAAOoR,EAAP,KAAoBC,EAApB,KACI9D,EAAO,KAcX,GAZIA,EADS,SAATvF,EACO,qBAAKpB,UAAU,SAASa,MAAO,CAAC6J,WAAW,aAAD,OAAe3J,GAAS5D,EAAS,IAAMgK,MAAO,QAAxF,SAAkGhK,IAGrG,qCACI,qBAAK6C,UAAU,SAASa,MAAO,CAAC6J,WAAW,aAAD,OAAe3J,GAAS5D,EAAS,KAA3E,SAAmFA,IACnF,sBAAK6C,UAAU,mBAAf,UACI,qBAAKA,UAAU,eAAeQ,QAAS,kBAAM8D,EAAS,CAAC1B,OAAQ,SAAUvJ,KAAM,CAACwC,OAAMsB,OAAQU,KAAK0E,IAAI,EAAGpF,EAAS,OAAnH,eACA,qBAAK6C,UAAU,eAAeQ,QAAS,kBAAM8D,EAAS,CAAC1B,OAAQ,SAAUvJ,KAAM,CAACwC,OAAMsB,OAAQU,KAAK2L,IAAI,EAAGrM,EAAS,OAAnH,qBAKZS,EAAK,CACL3C,QAAQC,IAAI,sBACZ,IAAM6E,EAAM,CAACqB,OAAMgD,YAAWE,YACxBqG,EAAyB,IAAf/M,EAAIkE,OAAe,cAAC+E,GAAD,2BAAW9G,GAAX,IAAgBnC,IAAKA,EAAI,MAAQ,cAACkJ,GAAD,2BAAe/G,GAAf,IAAoBnC,IAAKA,KAC7F,OAAQ,qCACJ,qBAAKoC,UAAU,QAAQa,MAAO,CAAC+J,UAAWJ,EAAc,IAAM,OAA9D,SACK7D,IAEL,qBAAK9F,MAAO,CAACqI,OAAQ,QAAS1I,QAAS,kBAAMiK,GAAY,SAAAI,GAAC,OAAKA,MAAIR,aAAc,kBAAMI,GAAY,IAAnG,SACKE,OAIb,OAAO,qBAAK3K,UAAU,QAAf,SAAwB2G,IASpBmE,OA3Nf,WACI,MAAgC3R,IAAMC,SAAS,MAA/C,mBAAO6F,EAAP,KAAiB8L,EAAjB,KACA,EAA8B5R,IAAMC,SAAS,MAA7C,mBAAO6C,EAAP,KAAgB+O,EAAhB,KACA,EAAwB7R,IAAMC,SAAS,QAAvC,mBAAOgI,EAAP,KAAa6J,EAAb,KAGA,GAFA9R,IAAMS,WAAU,kBAAMiB,IAAepB,KAAKsR,KAAc,IACxD5R,IAAMS,WAAU,iBAAe,SAATwH,GAAmBtF,IAAerC,KAAKuR,KAAa,CAAC5J,IAC1D,OAAbnC,GAA+B,SAATmC,GAA+B,OAAZnF,EACzC,OAAO,qDAEX,IAAM4H,EAAU,GACVqH,EAAa,CAACrH,UAASzC,OAAMzC,MAAO,wBAmB1C,MAlBa,eAATyC,EACAyC,EAAQc,KAAK,CACTrJ,KAAM,qBACN4I,GAAI,SAASiH,GACTJ,EAAY,MACZhP,EAAsBoP,GAAM1R,MAAK,kBAAMoB,IAAepB,KAAKsR,SAGnD,SAAT3J,IACPyC,EAAQc,KAAK,CACTrJ,KAAM,SACN4I,GAAI,SAASkH,GACTJ,EAAW,MFlEpB,SAAP,kCEmEgBK,CAAYD,GAAQ3R,MAAK,kBAAMqC,IAAerC,KAAKuR,GAAYvR,MAAK,kBAAMwR,EAAQ,iBAG1FC,EAAWvH,YAAc1H,GAGzB,qCACI,cAAC,GAAD,aAAUiF,aAAcjC,GAAciM,IACtC,gCACI,cAAC3K,GAAD,CAAQC,QAAS,kBAAMyK,EAAQ,SAA/B,kBACA,cAAC1K,GAAD,CAAQC,QAAS,kBAAMyK,EAAQ,eAA/B,yBACA,cAAC1K,GAAD,CAAQC,QAAS,kBAAMyK,EAAQ,SAA/B,+C,MC1LD,SAASK,KACpB,IAAMhH,EAAWnL,IAAMoS,WAAWC,IAClC,EAA2BrS,IAAMC,SAAS,IAA1C,mBAAOqS,EAAP,KAAgBC,EAAhB,KACA,EAA2BvS,IAAMC,SAAS,IAA1C,mBAAOuS,EAAP,KAAgBC,EAAhB,KAWA,OACI,uBAAMC,SALV,SAAkBhE,GACdA,EAAMC,iBHNP,SAAP,oCGOQgE,CAAML,EAASE,GAASlS,MAAK,SAAAsS,GAAE,OAAIzH,EAAS,CAAC1B,OAAQ,QAASvJ,KAAM0S,OAAMrS,MAAMC,QAGhF,UACI,uBAAOiC,KAAK,OAAON,KAAK,OAAO0Q,MAAOP,EAASQ,SAZvD,SAAsBpE,GAClB6D,EAAQ7D,EAAMqE,OAAOF,QAWsDG,UAAQ,EAACC,YAAY,UAAS,uBACrG,uBAAOxQ,KAAK,WAAWN,KAAK,WAAW0Q,MAAOL,EAASM,SAV/D,SAAsBpE,GAClB+D,EAAQ/D,EAAMqE,OAAOF,QAS8DG,UAAQ,EAACC,YAAY,eAAS,uBAC7G,cAAC7L,GAAD,CAAQ8L,QAAM,EAAC7L,QAAS,kBAAMvF,QAAQC,IAAI,mBAA1C,uBAKL,SAASoR,KACZ,IAAMhI,EAAWnL,IAAMoS,WAAWC,IAElC,OADarS,IAAMoS,WAAWgB,IAGtB,sBAAM1L,MAAO,CAAC2L,MAAO,SAAUhM,QAAS,WACpC8D,EAAS,CAAC1B,OAAQ,YADtB,qBAMJ,sBAAM/B,MAAO,CAAC2L,MAAO,SAAUhM,QAAS,WACpC8D,EAAS,CAAC1B,OAAQ,aAAcvJ,KAAM,cAACiS,GAAD,OAD1C,oB,MCjCD,SAASmB,GAAT,GAA6C,IAA1BC,EAAyB,EAAzBA,SAAUC,EAAe,EAAfA,KAAMC,EAAS,EAATA,MAChCtI,EAAWnL,IAAMoS,WAAWC,IAClC,OAAQ,uBAAMhL,QAAS,kBAAM8D,EAAS,CAAC1B,OAAQ,aAAcvJ,KAAMsT,KAA3D,UACHD,EACAE,GAAS,qBAAK5M,UAAU,iBAAf,SAAiC4M,OAInD,SAASC,GAAT,GAA8B,IAAXC,EAAU,EAAVA,OACf,OAAO,sBAAMtM,QAASsM,EAAf,eASI,SAASC,GAAT,GAAuC,IAArBC,EAAoB,EAApBA,MAAOC,EAAa,EAAbA,UACpC,EAA+B9T,IAAMC,UAAS,GAA9C,mBAAO8T,EAAP,KAAoBC,EAApB,KACM1P,EAAOtE,IAAMoS,WAAWgB,IACxBa,EAAS,6EACf,OAAIH,EAAY,IAER,gCACI,qBAAKpM,MAAO,CAACwM,QAASH,EAAc,QAAU,QAA9C,SACKF,EAAM5O,KAAI,SAACkP,EAAMtL,GAAP,OAAa,cAACyK,GAAD,CAAiBE,KAAMlP,EAAO6P,EAAKX,KAAOS,EAAQG,OAAO,EAAMX,MAAOU,EAAKV,MAA3E,SAAmFU,EAAKhS,MAA1E0G,QAE1C,cAAC6K,GAAD,CAASC,OAAQ,WAAYK,GAAQ,SAAAK,GAAI,OAAKA,QAC9C,cAAClB,GAAD,OAKR,gCACI,cAACA,GAAD,IACCU,EAAM5O,KAAI,SAACkP,EAAMtL,GAAP,OAAa,cAACyK,GAAD,CAAiBE,KAAMlP,EAAO6P,EAAKX,KAAOS,EAAQG,OAAO,EAAOX,MAAOU,EAAKV,MAA5E,SAAoFU,EAAKhS,MAA3E0G,S,MCrClD,SAASyL,GAAcnS,GACnB,MAAM,oBAAN,OAA2BA,GAG/B,SAASoS,GAAWxG,GAChB,MAAwB/N,IAAMC,SAAS,IAAvC,mBAAOuU,EAAP,KAAaC,EAAb,KAIA,OAHAzU,IAAMS,WAAU,WACZgU,EAAQH,GAAcvG,EAAM5L,SAC7B,CAAC4L,EAAM5L,OAEN,gCACI,6BAAK4L,EAAM5L,OACVqS,KAKb,SAASE,GAAc3G,GACnB,MAAwB/N,IAAMC,SAAS,IAAvC,mBAAOuU,EAAP,KAAaC,EAAb,KAIA,OAHAzU,IAAMS,WAAU,WACZgU,EAAQH,GAAcvG,EAAM5L,SAC7B,CAAC4L,EAAM5L,OAEN,8BACKqS,IAkBb,SAASG,GAAO5G,GACZ,MAAgC/N,IAAMC,UAAS,GAA/C,mBAAO2U,EAAP,KAAiBtD,EAAjB,KACA,OACI,qCACI,qBAAKzK,UAAU,SAASQ,QAAS,WAC7BiK,GAAY,SAAA+C,GAAI,OAAKA,MADzB,SAEItG,EAAM5L,OACV,sBAAK0E,UAAU,cAAca,MAAO,CAAC+J,UAAWmD,EAAW,MAAQ,OAAnE,UACI,cAACtB,GAAD,CAASE,KAAM,cAACe,GAAD,CAAYpS,KAAM4L,EAAM5L,OAAvC,+BACA,cAACmR,GAAD,CAASE,KAAM,cAACkB,GAAD,CAAevS,KAAM4L,EAAM8G,gBAA1C,4CAMDC,OA5Bf,WACI,MAAkBhV,EAAc2B,GAAzBsT,EAAP,oBACA,OAAgB,OAAZA,EACO,qDAGP,sBAAK3S,GAAG,UAAUyE,UAAU,cAA5B,4BAEKkO,EAAQ9P,KAAI,SAAA+P,GAAG,OAAI,cAACL,GAAD,CAAqBxS,KAAM6S,EAAI7S,MAAlB6S,EAAI5S,W,YCtClC,SAAS6S,KACpB,MAAkBnV,EAAcuE,GAAzB0Q,EAAP,oBACA,OAAgB,OAAZA,EACO,oDAGP,sBAAKlO,UAAU,cAAf,uBAEKkO,EAAQ9P,KAAI,SAAA+P,GAAG,OAAI,sBAAKnO,UAAU,UAAf,UAA0BmO,EAAI7S,KAA9B,IAAoC,sBAAM0E,UAAU,QAAhB,SAAyBmO,EAAIzQ,iB,MCPlF,SAAS2Q,KACpB,MAAmCpV,EAAc0E,GAAjD,mBAAO2Q,EAAP,KAAoBC,GAApB,WACMC,EAAarV,IAAMK,aAAY,SAAS+B,GAC1CgT,GAAY,SAAAE,GAAI,OAAIA,EAAKrO,QAAO,SAAAsB,GAAC,OAAIA,EAAEnG,KAAOA,UAC/C,CAACgT,IACJ,OAAiB,OAAbD,EACO,sDAGP,sBAAKtO,UAAU,cAAf,sCAEKsO,EAASlQ,KAAI,SAAAsQ,GAAG,OAAI,cAACC,GAAD,2BAA2BD,GAA3B,IAAgCE,IAAKJ,IAAtBE,EAAInT,UAKpD,SAASoT,GAAT,GAA+C,IAA3BpT,EAA0B,EAA1BA,GAAIyC,EAAsB,EAAtBA,KAAMJ,EAAgB,EAAhBA,IAAKK,EAAW,EAAXA,GAAI2Q,EAAO,EAAPA,IACnC,EAA8BzV,IAAMC,UAAS,GAA7C,mBAAOyV,EAAP,KAAgBC,EAAhB,KACA,OACI,sBAAK9O,UAAU,UAAf,UACKpC,EAAItC,KADT,IACgBsC,EAAIhC,KADpB,KAC4BoC,EAD5B,QACuCC,EACnC,sBAAM+B,UAAU,kBAAhB,SAAmC6O,EAAU,mBAAsB,qCAAE,cAACtO,GAAD,CAAQC,QAAS,WAClFsO,GAAW,GP2FpB,SAAP,kCO1FgBC,CAAexT,GAAI9B,MAAK,kBAAMmV,EAAIrT,MAAK7B,OAAM,kBAAMoV,GAAW,OAFG,wBAIrE,cAACvO,GAAD,CAAQC,QAAS,WACbsO,GAAW,GP4FpB,SAAP,kCO3FgBE,CAAezT,GAAI9B,MAAK,kBAAMmV,EAAIrT,MAAK7B,OAAM,kBAAMoV,GAAW,OAFlE,iCCzBG,SAASG,KACpB,IACMjR,EAAyB,iBADlB7E,IAAMoS,WAAWgB,IACZ2C,SAClB,EAA6BjW,EAAciF,GAA3C,mBAAOC,EAAP,KAAiBgR,GAAjB,WACA,EAAsBjQ,KAAtB,mBAAOC,EAAP,KAAcC,EAAd,KACMjD,EAAUhD,IAAMK,aAAY,SAAiB+B,IRiLhD,SAAP,mCQhLQ6T,CAAY7T,GAAI9B,MAAK,SAASiB,GAC1B,IAAM2U,EAAOhS,OAAO4F,QAAQvI,GAAKuH,QAAO,SAACqN,EAAIC,GAAL,OAAYD,EAAG,GAAKC,EAAG,GAAKD,EAAKC,KAAI,GAC7E,OAAOnQ,GAAK,kBAAM,cAAC,GAAD,CACdT,MAAM,gBACNgF,YAAajJ,EACbyG,eAAc,eAAIkO,GAAO,GACzBjO,KAAK,eAEV1H,MAAM6H,MACV,IACGiO,EAAOrW,IAAMK,aAAY,SAAS+B,IR6TrC,SAAP,mCQ5TQkU,CAAelU,GAAI9B,MAAK,SAAA8C,GAAK,OAAI6C,GAAK,SAAAsQ,GAAU,OAAI,cAAC,GAAD,CAChD/L,YAAapH,EACb6E,KAAK,OACLyC,QAAS,CAAC,CACNvI,KAAM,cACN4I,GAAIwL,YAETjW,MAAK,SAAAkW,GAAK,OR8Kd,SAAP,oCQ9KyBC,CAASrU,EAAIoU,KAAQpO,MACvC,IACG1B,EAAM1G,IAAMK,aAAY,WAC1B4F,GAAK,SAAA6B,GAAC,OAAI,cAAC4O,GAAD,CAAexO,SAAUJ,OAC9BxH,MAAK,SAAAqW,GAAI,ORiQf,SAAP,kCQjQ0BC,CAAeD,MAC5BrW,MAAK,SAAA8C,GAAK,OAAI6C,GAAK,SAAA6B,GAAC,OAAI,cAAC+O,GAAD,CAAc3O,SAAUJ,EAAGgP,UAAW1T,UAC9D9C,MAAK,mBR0GX,SAAP,oCQ1GqCyW,CAAnB,EAAE5U,KAAF,EAAQiB,UACb9C,MAAK,SAAA0W,GAAO,OAAIhB,GAAS,SAAAiB,GAAG,4BAAQA,GAAR,CAAaD,UAAW,SAASE,GAC1D,GAAY,cAARA,EACA,MAAMA,EAEN1W,MAAM,qCAGbD,MAAM6H,MACZ,IACG+O,EAASnX,IAAMK,aAAY,SAAS+B,IRmFvC,SAAP,mCQlFQgV,CAAWhV,GAAI9B,MAAK,kBAAM0V,GAAS,SAAAiB,GAAG,OAAIA,EAAIhQ,QAAO,SAAAoQ,GAAC,OAAIA,EAAEjV,KAAOA,WAAM,kBAAM5B,MAAM,kCACtF,IACH,OAAc,OAAVwE,EACO,mDAGP,qCACI,sBAAK6B,UAAU,cAAf,oBAEK7B,EAAMC,KAAI,SAAA1B,GAAI,OAAI,cAAC+T,GAAD,2BAAwB/T,GAAxB,IAA8BP,QAASA,EAASmU,OAAQA,EAAQd,KAAMxR,EAAOwR,EAAO,OAAzE9S,EAAKnB,UAEtCyC,GAAQ,8BAAK,cAACuC,GAAD,CAAQC,QAASX,EAAjB,qBACbV,KAKb,SAASsR,GAAT,GAA2D,IAA3ClV,EAA0C,EAA1CA,GAAID,EAAsC,EAAtCA,KAAMoV,EAAgC,EAAhCA,MAAOvU,EAAyB,EAAzBA,QAASmU,EAAgB,EAAhBA,OAAQd,EAAQ,EAARA,KAC9C,OACI,sBAAKxP,UAAU,UAAf,UACK1E,EACD,sBAAM0E,UAAU,kBAAhB,SACKwP,EAAO,qCAAGkB,GAAS,mBAAc,cAACnQ,GAAD,CAAQC,QAAS,kBAAMgP,EAAKjU,IAA5B,4BAClC,qCAAE,cAACgF,GAAD,CAAQC,QAAS,kBAAMrE,EAAQZ,IAA/B,mBACF,cAACgF,GAAD,CAAQC,QAAS,kBAAM8P,EAAO/U,IAA9B,kCAMhB,SAASyU,GAAT,GAAgD,IAAxB3O,EAAuB,EAAvBA,SAAU4O,EAAa,EAAbA,UACxBU,EAAWxX,IAAM6K,SACvB,EAAkC7K,IAAMqG,SAAQ,WAC5C,IAAMoR,ENkSP,SAAyBzL,GAC5B,IAAM0L,EAAU,GAEhB,OADArU,MAAMC,KAAKD,MAAM,IAAIc,QAAQjC,SAAQ,SAAA2G,GAAM6O,EAAQ7O,EAAE,IAAK,KACnD,2BAAI6O,GAAY1L,GMrSD2L,CAAgBb,GAC5BhK,EAAW,IAAItG,IAErB,OADAtC,OAAOC,KAAKsT,GAAWvV,SAAQ,SAAAQ,GAAI,OAAIA,KAAQoU,GAAahK,EAASpG,IAAIhE,MAClE,CAAC+U,EAAW3K,KACpB,CAACgK,IALJ,mBAAOc,EAAP,KAAsB9K,EAAtB,KAMM+K,EAAkB7X,IAAM6K,OAAO,MACrC,EAAwB7K,IAAMC,SAAS,IAAvC,mBAAOkC,EAAP,KAAaoQ,EAAb,KACA,OACI,qCACI,qBAAK7K,MAAO,CAACoQ,aAAc,SAA3B,SACI,sBAAM1V,GAAG,qBAAqByE,UAAU,aAAa6L,SAAU,SAAShE,GACpEA,EAAMC,iBACNzG,EAAS,CAAC/F,OAAMiB,MAAOyU,EAAgB7N,aAF3C,SAII,8BACI,uBACIvH,KAAK,OACLoQ,MAAO1Q,EACP2Q,SAAU,SAAApE,GAAK,OAAI6D,EAAQ7D,EAAMqE,OAAOF,QACxCG,UAAQ,EACRC,YAAY,2BAK5B,qBAAK5L,QAAS,kCAAMmQ,EAASxN,eAAf,aAAM,EAAkB+N,SAAtC,SACI,cAAC,GAAD,CACI/P,eAAgB4P,EAChBnN,cAAeqC,EACf7E,KAAK,SACL2C,cAAe,SAAAoN,GAAM,OAAI,kBAAMH,EAAgB7N,QAAUgO,QAGjE,8BACI,cAAC5Q,GAAD,CAAQ+E,IAAKqL,EAAUS,KAAK,qBAAqB/E,QAAM,EAAvD,4B,MC9GD,SAASgF,KACpB,MAAgBpY,EAAcyF,GAAvB4S,EAAP,oBACA,OAAc,OAAVA,EACO,kDAGP,sBAAKtR,UAAU,cAAczE,GAAG,WAAhC,6BAEK+V,EAAMlT,KAAI,SAAAuP,GAAI,OAAI,sBAAK3N,UAAU,UAAf,UACf,6BAAK2N,EAAKhP,QACV,qBAAKqB,UAAU,WAAf,SACK2N,EAAK/O,gBCVX,SAAS2S,KAAW,IAAD,EAC9B,EAAkBtY,EAAc4F,GAAzB2S,EAAP,oBACMC,EAActY,IAAMqG,SAAQ,yBAAMgS,QAAN,IAAMA,OAAN,EAAMA,EAASpT,KAAI,SAAA2D,GAAC,OAAIA,EAAEzG,UAAO,CAACkW,IACpE,EAAgCrY,IAAMC,SAAS,MAA/C,mBAAOsY,EAAP,KAAiBC,EAAjB,KACA,EAA4BxY,IAAMC,SAAS,MAA3C,mBAAOwY,EAAP,KAAeC,EAAf,KACA,OAAgB,OAAZL,EACO,qDAGP,sBAAKxR,UAAU,cAAf,uBAEI,cAACC,GAAD,CAAWC,SAAU,SAAS4R,GAC1BD,EAAU,MACVF,EAAYH,EAAQpR,QAAO,SAAA2B,GAAC,OAAIA,EAAEzG,KAAKgF,SAASwR,QACjDL,YAAaA,IALpB,iBAMKG,QANL,IAMKA,OANL,EAMKA,EAAQhT,YANb,eAMqB8S,QANrB,IAMqBA,OANrB,EAMqBA,EAAUtT,KAAI,SAAA2D,GAAC,OAAI,sBAAgB/B,UAAU,cAA1B,UAAyC+B,EAAEzG,KAAK,cAACiF,GAAD,CAAQC,QAAS,YV6V1G,SAAP,mCU5VgBuR,CAAgBhQ,EAAExG,IAAI9B,KAAKoY,IADqD,uBAAtC9P,EAAExG,UCd7C,SAASyW,KACpB,MAAsC7Y,IAAMC,SAAS,MAArD,mBAAO6Y,EAAP,KAAwBC,EAAxB,KACA,EAA4B/Y,IAAMC,SAAS,MAA3C,mBAAOkF,EAAP,KAAe6T,EAAf,KAEA,OADAhZ,IAAMS,WAAU,kBAAiB,OAAX0E,GAAmBG,EAAmBH,GAAQ7E,KAAKyY,KAAa,CAAC5T,IAEnF,sBAAK0B,UAAU,cAAf,UACI,cAAC6P,GAAD,CAAexO,SAAU8Q,IACxBF,GAAmB,cAAC,GAAD,CAChB/Q,aAAc+Q,EACdnO,aAAW,EACX1C,KAAM,aACNyC,QAAS,CAAC,CACNvI,KAAM,aACN4I,GAAI,SAASiH,GACT+G,EAAW,MACXnW,EAAsBoP,GACjB1R,MAAK,kBAAMgF,EAAmBH,GAC9B7E,KAAKyY,cCP3B,IAAM3F,GAAcpT,IAAMiZ,gBACpB5G,GAAkBrS,IAAMiZ,gBAErC,SAASC,GAAa1P,EAAtB,GAAgD,IAAjBC,EAAgB,EAAhBA,OAAQvJ,EAAQ,EAARA,KACnC,OAAQuJ,GACJ,IAAK,SACD,OAAO,2BAAID,GAAX,IAAkBwE,MAAOc,OAAOqK,aACpC,IAAK,QACD,OAAO,2BAAI3P,GAAX,IAAkBlF,KAAMpE,EAAMkZ,QAAS,cAAC,GAAD,MAC3C,IAAK,SACD,OAAO,2BAAI5P,GAAX,IAAkBlF,KAAM,KAAM8U,QAAS,cAACjH,GAAD,MAC3C,IAAK,aACD,OAAO,2BAAI3I,GAAX,IAAkB4P,QAASlZ,KAIxB,SAASmZ,KACpB,MAA6CrZ,IAAMkL,WAAWgO,GAAc,CACxEE,QAAS,cAACjH,GAAD,IACT7N,KAAM,KACN0J,MAAOc,OAAOqK,aAHlB,0BAASC,EAAT,EAASA,QAAS9U,EAAlB,EAAkBA,KAAM0J,EAAxB,EAAwBA,MAAS7C,EAAjC,KAMAnL,IAAMS,WAAU,WACZ,IAAI6Y,EAAc,kBAAMnO,EAAS,CAAC1B,OAAQ,YAE1C,OADAqF,OAAOc,iBAAiB,SAAU0J,GAC3B,kBAAMxK,OAAOe,oBAAoB,SAAUyJ,MACnD,IAOH,IAAMzF,EAAQ,CACV,CAAC1R,KAAM,uBAAcqR,KAAM,cAAC,GAAD,KAC3B,CAACrR,KAAM,UAAWqR,KAAM,cAACsC,GAAD,IAAUrC,MAAOnP,EAAO,QAAKmD,GACrD,CAACtF,KAAM,mBAAeqR,KAAM,cAAC,GAAD,KAC5B,CAACrR,KAAM,aAAcqR,KAAM,cAAC4E,GAAD,MAqB/B,OAlBI9T,IACIA,EAAKyR,SACTlC,EAAMrI,KAAN,MAAAqI,EAAc,CACd,CAAC1R,KAAM,QAASqR,KAAM,cAAC,GAAD,KACtB,CAACrR,KAAM,aAAcqR,KAAM,cAAC,GAAD,KAC3B,CAACrR,KAAM,cAAeqR,KAAM,cAAC,EAAD,OAMxBK,EAAMrI,KAAK,CAACrJ,KAAM,cAAeqR,KAAM,cAAC,GAAD,IAAoBC,MAAOnP,EAAO,OAAImD,IAE7EnD,EAAKiV,SACL1F,EAAMrI,KAAK,CAACrJ,KAAM,OAAQqR,KAAM,cAACqF,GAAD,OAKpC,cAACxG,GAAgBmH,SAAjB,CAA0B3G,MAAO1H,EAAjC,SACA,eAACiI,GAAYoG,SAAb,CAAsB3G,MAAOvO,EAA7B,UACI,cAACsP,GAAD,CAAQC,MAAOA,EAAOC,UAAW9F,IACjC,cAACyL,GAAD,UACKL,IAEL,cAACM,GAAD,SAMZ,SAASD,GAAT,GAAmC,IAAblG,EAAY,EAAZA,SAClB,OACI,qBAAKnR,GAAG,UAAR,SACI,8BACKmR,MAMV,IAAMnM,GAASpH,IAAM2Z,YAAW,SAAS,EAAuDxN,GAAM,IAA3D9E,EAA0D,EAA1DA,QAASkM,EAAiD,EAAjDA,SAAUL,EAAuC,EAAvCA,OAAQxL,EAA+B,EAA/BA,MAAOkS,EAAwB,EAAxBA,UAAW3B,EAAa,EAAbA,KAC3F,EAA8BjY,IAAMC,UAAS,GAA7C,mBAAO4Z,EAAP,KAAgBC,EAAhB,KAEA,OADA9Z,IAAMS,WAAU,kBAAMmZ,GAAazN,EAAInC,QAAQ+N,UAAS,IAEpD,iDACIlR,UAAW,UAAYgT,EAAU,kBAAoB,IACrDxS,QAASA,EACToH,YAAa,kBAAMqL,GAAW,IAC9BvJ,UAAW,kBAAMuJ,GAAW,IAC5B5I,aAAc,kBAAM4I,GAAW,IAC/BrX,KAAMyQ,EAAS,SAAW,GAC1BxL,MAAOA,EACPyE,IAAKA,GACA8L,EAAO,CAACA,QAAQ,IATzB,cAWI,qBAAKpR,UAAU,SAAf,SAAyB0M,IACzB,qBAAK1M,UAAW,SAAYgT,EAAU,iBAAmB,IAAzD,SAA+DtG,WAKpE,SAASzM,GAAT,GAA+D,IAA1CC,EAAyC,EAAzCA,SAAUuR,EAA+B,EAA/BA,YAAayB,EAAkB,EAAlBA,eAC/C,EAA4B/Z,IAAMC,SAAS,IAA3C,mBAAO+Z,EAAP,KAAkBC,EAAlB,KACA,EAA8Bja,IAAMC,UAAS,GAA7C,mBAAO0Q,EAAP,KAAgBC,EAAhB,KACA,EAAsC5Q,IAAMC,SAAS,MAArD,mBAAOia,EAAP,KAAoBC,EAApB,KACA,EAAgCna,IAAMC,UAAS,GAA/C,mBAAOma,EAAP,KAAiBC,EAAjB,KACMC,EAAmBta,IAAMqG,SAAQ,yBAAMiS,QAAN,IAAMA,OAAN,EAAMA,EACvCrR,QAAO,SAAAsT,GAAG,OAAIA,EAAIpT,SAAS6S,QACjC,CAAC1B,EAAa0B,IACd,OACI,uBAAMtH,SAAU,SAAShE,GACrBA,EAAMC,iBACN5H,EAASiT,IACVQ,aAAa,MAHhB,UAII,sBAAM3T,UAAU,aAAhB,UACI,uBACIpE,KAAK,OACLN,KAAK,OACL0Q,MAAOmH,EACPlH,SAAU,SAASpE,GACfyL,EAAe,MACfF,EAAOvL,EAAMqE,OAAOF,OACpBwH,GAAY,IAEhBI,QAAS,kBAAM7J,GAAW,IAC1B8J,OAAQ,kBAAM9J,GAAW,IACzB+J,UAAW,SAASjM,GAChB,OAAOA,EAAMkM,KACT,IAAK,YACDT,GAAe,SAAAtR,GAAC,OAAInE,KAAK0E,KAAI,OAACP,QAAD,IAACA,KAAM,GAAK,EAAGyR,EAAiB3R,OAAS,MACtE,MACJ,IAAK,UACDwR,GAAe,SAAAtR,GAAC,OAAU,OAANA,GAAoB,IAANA,EAAU,KAAOA,EAAI,KACvD,MACJ,IAAK,QACD,GAAoB,OAAhBqR,EAAsB,CACtBxL,EAAMC,iBACN,IAAM4L,EAAMD,EAAiBJ,GAC7BD,EAAOM,GACPJ,EAAe,MACfE,GAAY,GACZN,GAAkBhT,EAASwT,MAI3CvH,UAAQ,EACRC,YAAY,qBAEftC,GAAW2J,GAAoBF,GAC5B,qBAAKvT,UAAU,cAAf,SACKyT,EAAiBrV,KAAI,SAACsV,EAAK1R,GAAN,OAAY,qBAC9BhC,UAAW,cAAgBgC,IAAMqR,EAAc,gBAAkB,IACjEzL,YAAa,WACTwL,EAAOM,GACPJ,EAAe,MACfE,GAAY,GACZN,GAAkBhT,EAASwT,IAND,SAQhCA,GAR0C1R,WAYxD,cAACzB,GAAD,CAAQ8L,QAAM,EAAd,uBAKZ,SAASwG,KACL,OACI,qBAAKtX,GAAG,SAAR,+BAMD,SAAS2D,KACZ,IAAM8U,EAAW7a,IAAM6K,OAAO,MAC9B,EAA4B7K,IAAMC,SAAS,MAA3C,mBAAO6a,EAAP,KAAiBC,EAAjB,KAEA,OADA/a,IAAMS,WAAU,kBAAM,kCAAMoa,EAAS7Q,eAAf,aAAM,OAAA6Q,MAAsB,IAC3C,CAACC,EAAU,SAASE,GACvB,OAAO,IAAIjY,SAAQ,SAASC,EAASE,GAEjC,SAAS+X,IACLF,EAAQ,MACR7X,EAAO,gBAHX2X,EAAS7Q,QAAU9G,EAKnB6X,EACI,qBAAKlU,UAAU,mBAAmBQ,QAAS,SAAAqH,GAAK,OAAIA,EAAMqE,SAAWrE,EAAME,eAAiBqM,KAA5F,SACI,sBAAKpU,UAAU,SAAf,UACI,qBAAKA,UAAU,aAAf,SACI,cAACO,GAAD,CAAQC,QAAS4T,EAAjB,iBAEHD,GAAW,SAAS9a,GACjB6a,EAAQ,MACR/X,EAAQ9C,iBAS7B,SAASwW,GAAT,GAAsC,IAAbxO,EAAY,EAAZA,SACtBgT,EAAYlb,IAAM6K,SACxB,EAAoB/K,EAAcoF,GAA3BiW,EAAP,oBACA,EAA4Bnb,IAAMC,SAAS,IAA3C,mBAAOkF,EAAP,KAAe6T,EAAf,KACMoC,EAAapb,IAAMqG,SAAQ,yBAAM8U,QAAN,IAAMA,OAAN,EAAMA,EAAWlW,KAAI,SAAAoW,GAAE,OAAIA,EAAGlZ,UAAO,CAACgZ,IACvE,OAAkB,OAAdA,EACO,6CAGP,sBAAKtU,UAAU,iBAAf,UACI,cAACC,GAAD,CAAWiT,gBAAc,EAAChT,SAAU,SAASiT,GAAY,IAAD,EAC9CsB,EAAY,GAClBH,EAAUjZ,SAAQ,SAASkD,GACnBA,EAAIjD,KAAKgF,SAAS6S,KAClB7U,EAAOgC,SAAS/B,IAAQkW,EAAU9P,KAAKpG,OAG/C4T,GAAU,SAAAuC,GAAC,4BAAQA,GAAMD,MACzB,UAAAJ,EAAUlR,eAAV,SAAmB+N,SACpBO,YAAa8C,IACfjW,EAAOF,KAAI,SAAAG,GAAG,OAAI,gCAAmBA,EAAIjD,KAAK,cAACiF,GAAD,CAAQC,QAAS,WAC5D2R,GAAU,SAASuC,GACf,IAAMC,EAAE,YAAOD,GAEf,OADAC,EAAGC,OAAOF,EAAEhP,QAAQnH,GAAM,GACnBoW,MAJgC,iBAAlBpW,EAAIhD,OAOd,IAAlB+C,EAAOwD,QAAgB,cAACvB,GAAD,CAAQC,QAAS,kBAAMa,EAAS/C,IAASgH,IAAK+O,EAAWtB,WAAS,EAAlE,wBAK7B,SAASxR,GAAY8O,GACxB,GAAY,iBAARA,EACA,MAAMA,EC9Pd,IAYewE,GAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,6BAAqBtb,MAAK,YAAkD,IAA/Cub,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCFdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,GAAD,MAEFnb,SAASob,eAAe,SAM1BX,O","file":"static/js/main.aa333fef.chunk.js","sourcesContent":["import React from 'react';\r\nconst dummyData = false;\r\n\r\nexport function useRemoteData(fetcher) {\r\n    const [data, setData] = React.useState(null);\r\n    const refresh = React.useCallback(() => fetcher().then(setData).catch(alert), [fetcher])\r\n    React.useEffect(refresh, [refresh]);\r\n    return [data, refresh, setData];\r\n}\r\n\r\nexport async function login(username, passowrd) {\r\n    if (dummyData) {\r\n        return {username, security: username === \"student\" ? \"ROLE_USER\" : \"ROLE_ADMIN\", position: username === \"student\" ? \"ROLE_STUDENT\" : \"ROLE_EMPLOYEE\"};\r\n    }\r\n    const loginData = new FormData();\r\n    loginData.append(\"username\", username);\r\n    loginData.append(\"password\", passowrd);\r\n    const loginRes = await fetch(\"http://\" + document.location.host + \"/login\", {method: 'POST', body: loginData});\r\n    if (loginRes.status === 404) {\r\n        throw \"Login failed\";\r\n    }\r\n    return await fetch(\"http://\" + document.location.host + \"/logged\")\r\n        .then(res => res.json()).catch(alert);\r\n}\r\n\r\nexport async function fetchCourses() {\r\n    if (dummyData) {\r\n        return [\r\n            {\r\n                name: \"WSI\",\r\n                id: \"0\"\r\n            },\r\n            {\r\n                name: \"pap\",\r\n                id: \"1\"\r\n            }\r\n        ]\r\n    }\r\n    return await fetch(\"http://\" + document.location.host + \"/classes\").then(res => res.json());\r\n}\r\n\r\nexport async function fetchClasses() {\r\n    if (dummyData) {\r\n        return {\r\n            0: {\r\n                name: \"WSI\",\r\n                slot: \"2\",\r\n                room: \"98\",\r\n                id: \"0\",\r\n                type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n                alts: [\"2\", \"29\"]\r\n            },\r\n            1: {\r\n                name: \"SI\",\r\n                slot: \"2\",\r\n                room: \"98\",\r\n                id: \"1\",\r\n                type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n                alts: []\r\n            },\r\n            2: {\r\n                name: \"Wsi\",\r\n                slot: \"2\",\r\n                room: \"11\",\r\n                id: \"2\",\r\n                type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n                alts: []\r\n            },\r\n            3: {\r\n                name: \"nji\",\r\n                slot: \"26\",\r\n                room: \"98\",\r\n                id: \"3\",\r\n                type: \"Laboratorium\",\r\n                alts: []\r\n            }\r\n        };\r\n    }\r\n    const url = new URL(\"http://\" + document.location.host + \"/classes\");\r\n    url.searchParams.append(\"flag\", \"alts\");\r\n    console.log(\"schedule requested\");\r\n    const classes = await fetch(url).then(res => res.json());\r\n    console.log(\"Classes obtained\");\r\n    console.log(classes);\r\n    const schedObj = {};\r\n    classes.forEach(({ name, id, roomNumber, class_type, timeSlotID }) => schedObj[id] = {\r\n        name,\r\n        id,\r\n        room: roomNumber,\r\n        type: class_type,\r\n        slot: timeSlotID\r\n    });\r\n    console.log(\"transformed schedule:\");\r\n    console.log(schedObj);\r\n    return schedObj;\r\n}\r\n\r\nexport async function fetchRatings() {\r\n\r\n    // [[1, 2], [1, 2]]\r\n    // {1: 2, 1: 2}\r\n    return ({\r\n        \"2\": 0,\r\n        \"26\": 2,\r\n        \"1\": 2,\r\n    });\r\n}\r\n\r\nexport async function pushRescheduleRequest(changes) {\r\n    console.log(changes);\r\n    return true;\r\n}\r\n\r\nexport async function pushRatings(ratings) {\r\n    console.log(ratings);\r\n    return true;\r\n}\r\n\r\nexport async function approveRequest(id) {\r\n    console.log(id);\r\n    return new Promise(resolve => setTimeout(() => resolve(true), 2000));\r\n}\r\n\r\nexport async function declineRequest(id) {\r\n    console.log(id);\r\n    return new Promise((resolve, reject) => setTimeout(() => reject(\"dht\"), 2000));\r\n}\r\n\r\nexport async function removePoll(id) {\r\n    if (dummyData) {\r\n        return true;\r\n    }\r\n    const data = new FormData();\r\n    data.append(\"pollID\", id);\r\n    const res = await fetch(\"http://\" + document.location.host + \"/delete-poll\", {method: 'POST', body: data});\r\n    if (!res.ok) {\r\n        throw \"not deleted\";\r\n    }\r\n    return true;\r\n}\r\n\r\nexport async function addPoll(name, slots) {\r\n    if (dummyData) {\r\n        return {\r\n            id: (new Date()).getTime(),\r\n            name\r\n        };\r\n    }\r\n    const data = new FormData();\r\n    data.append(\"name\", name);\r\n    data.append(\"slots\", Array.from(slots));\r\n    const res = await fetch(\"http://\" + document.location.host + \"/add-poll\", {method: 'POST', body: data});\r\n    if (!res.ok) {\r\n        throw \"not added\";\r\n    }\r\n    const poll = await res.json();\r\n    return {id: poll.pollID, name: poll.pollName};\r\n}\r\n\r\nexport async function subjectRegister(id) {\r\n    return true;\r\n}\r\n\r\nexport async function classRegister(sbjId, slot) {\r\n    return true;\r\n}\r\n\r\nexport async function fetchCoursesRegister() {\r\n    return [{\r\n        name: \"WSI\",\r\n        id: \"0\",\r\n    },\r\n    {\r\n        name: \"SOI\",\r\n        id: \"2\",\r\n        slots: [1, 2, 5]\r\n    },\r\n    {\r\n        name: \"PAP\",\r\n        id: \"3\",\r\n    },\r\n    {\r\n        name: \"PROB\",\r\n        id: \"4\",\r\n    }];\r\n}\r\n\r\nexport async function resolvePoll(id) {\r\n    if (dummyData) {\r\n        return {\r\n            \"2\": 13,\r\n            \"15\": 10,\r\n        }\r\n    }\r\n    const url = new URL(\"http://\" + document.location.host + \"/poll-result\");\r\n    url.searchParams.append(\"pollID\", id);\r\n    const res = await fetch(url);\r\n    const slotRts = await res.json();\r\n    const rObj = {};\r\n    slotRts.forEach(s => rObj[s.slotId] = s.rating);\r\n    return slotRts;\r\n}\r\n\r\nexport async function votePoll(id, rts) {\r\n    if (dummyData) {\r\n        return true;\r\n    }\r\n    const data = new FormData();\r\n    data.append(\"pollId\", id);\r\n    data.append(\"slotIds\", Object.keys(rts));\r\n    data.append(\"ratings\", Object.values(rts));\r\n    const res = await fetch(\"http://\" + document.location.host + \"/vote-poll\", {method: 'POST', body: data});\r\n    console.log(res.status);\r\n    return res.status;\r\n}\r\n\r\nexport async function fetchGrades(user) {\r\n    return ([{\r\n        name: \"WSI\",\r\n        grade: 3\r\n    },\r\n    {\r\n        name: \"SOI\",\r\n        grade: -10\r\n    }\r\n    ])\r\n}\r\n\r\nexport async function fetchRequests(user) {\r\n    return ([{\r\n        id: \"0\",\r\n        cls: {\r\n            name: \"WSI\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        stud: \"Jeremi S\",\r\n        to: \"3\"\r\n    },\r\n    {\r\n        id: \"1\",\r\n        cls: {\r\n            name: \"SOI\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        stud: \"Karol O\",\r\n        to: \"25\"\r\n    }\r\n    ])\r\n}\r\n\r\nexport async function fetchPolls() {\r\n    if (dummyData) {\r\n        return ([{\r\n            name: \"ankk\",\r\n            id: \"0\"\r\n        },\r\n        {\r\n            name: \"yyyy\",\r\n            id: \"1\"\r\n        }\r\n        ])\r\n    }\r\n    const res = await fetch(\"http://\" + document.location.host + \"/polls\");\r\n    const polls = await res.json();\r\n    console.log(polls);\r\n    return polls.map(({ pollName, pollID }) => ({name: pollName, id: pollID}));\r\n}\r\n\r\nexport async function fetchGroups() {\r\n    if (dummyData) {\r\n        return ([{\r\n            name: \"WSI\",\r\n            id: \"0\",\r\n        },\r\n        {\r\n            name: \"SOI - lab\",\r\n            id: \"1\",\r\n        },\r\n        {\r\n            name: \"Grupa I2\",\r\n            id: \"0\",\r\n        }\r\n        ]);\r\n    }\r\n    const url = new URL(\"http://\" + document.location.host + \"/classes\")\r\n    url.searchParams.append(\"flag\", \"all\");\r\n    const res = await fetch(url);\r\n    return await res.json();\r\n}\r\n\r\nexport async function fetchIntersect(groups) {\r\n    if (dummyData) {\r\n        return ({\r\n            \"8\": true,\r\n            \"12\": true,\r\n        });\r\n    }\r\n    const data = new FormData();\r\n    data.append(\"classIDs\", groups.map(grp => grp.id));\r\n    const res = await fetch(\"http://\" + document.location.host + \"/intersect\", {method: 'POST', body: data});\r\n    const slots = {};\r\n    (await res.json()).forEach(slt => slots[slt] = true);\r\n    return slots;\r\n}\r\n\r\nexport async function fetchGroupSchedule(groups) {\r\n    return {\r\n        0: {\r\n            name: \"WSI\",\r\n            slot: \"2\",\r\n            room: \"98\",\r\n            id: \"0\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        1: {\r\n            name: \"SI\",\r\n            slot: \"2\",\r\n            room: \"98\",\r\n            id: \"1\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        2: {\r\n            name: \"Wsi\",\r\n            slot: \"2\",\r\n            room: \"11\",\r\n            id: \"2\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        3: {\r\n            name: \"nji\",\r\n            slot: \"10\",\r\n            room: \"98\",\r\n            id: \"3\",\r\n            type: \"Laboratorium\",\r\n        }\r\n    };\r\n}\r\n\r\nexport async function fetchPollSlots(id) {\r\n    return {\"0\": 3, \"22\": 4};\r\n}\r\n\r\nexport async function fetchNews() {\r\n    return [\r\n        {\r\n            title: \"Som news\",\r\n            text: \"yyyyyyysapidfj aijsd 0iasj d0asdjo asj\"\r\n        },\r\n        {\r\n            title: \"Hee\",\r\n            text: \"0aijsdiwef0u82hgfy23h8irj1jkfi0owshdfsgbfhidb\"\r\n        }\r\n    ]\r\n}\r\n\r\nexport async function fetchWorkers() {\r\n    return [\r\n        {\r\n            name: \"Ewa S.\",\r\n            id: \"0\"\r\n        },\r\n        {\r\n            name: \"Peter Gawkuu\",\r\n            id: \"1\"\r\n        }\r\n    ];\r\n}\r\n\r\nexport async function fetchWorkerInfo(id) {\r\n    return {\r\n        text: \"Jakieś info o panu pracowniku\"\r\n    };\r\n}","import React from 'react';\r\nimport { Button, SearchBar, usePopup, verifyClose } from \"./App\";\r\nimport { classRegister, fetchClasses, fetchCourses, fetchCoursesRegister, fetchRatings, subjectRegister, useRemoteData } from \"./Remote\";\r\nimport { Schedule } from './Schedule';\r\nimport './Register.css';\r\n\r\nexport default function Register() {\r\n    const [allSubjects] = useRemoteData(fetchCoursesRegister);\r\n    const [mySubjects] = useRemoteData(fetchCourses);\r\n    const [schedule] = useRemoteData(fetchClasses);\r\n    const [ratings] = useRemoteData(fetchRatings);\r\n    const [popup, show] = usePopup();\r\n    const [currSubjects, setSubjects] = React.useState(null);\r\n    const registeredSubjects = React.useMemo(() => sbjSet(mySubjects), [mySubjects]);\r\n    if (allSubjects === null || registeredSubjects === null || ratings === null) {\r\n        return <div>Loading subjects...</div>;\r\n    }\r\n    const fwd = {show, schedule, ratings};\r\n    const subjects = currSubjects ?? allSubjects;\r\n    return (\r\n        <div className=\"content-box\">\r\n            <SearchBar onSearch={srch => setSubjects(allSubjects.filter(sub => sub.name.includes(srch)))}/>\r\n            {currSubjects !== null && <Button onClick={() => setSubjects(null)}>Wyczyść</Button>}\r\n            {subjects.map(sbj => <SubjectRegister sbj={sbj} alReg={registeredSubjects.has(sbj.id)} {...fwd}/>)}\r\n            {popup}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction SubjectRegister({ sbj, ratings, alReg, show, schedule }) {\r\n    const slots = React.useMemo(function() {\r\n        if (sbj.slots === undefined) {\r\n            return undefined;\r\n        }\r\n        const slots = {};\r\n        sbj.slots.forEach(slt => slots[slt] = true);\r\n        return slots;\r\n    }, [sbj])\r\n    return (\r\n        <div className=\"box-row\">\r\n            {sbj.name}\r\n            \r\n            <span className='resched-buttons'>{alReg ? \"Zarejestrowano\" : <>\r\n                {slots && <div className=\"indicator\" style={{backgroundColor: getColor(evalSlots(sbj.slots, ratings))}}/>}  \r\n                <Button onClick={function() {\r\n                    if (slots) {\r\n                        show(h => <Schedule\r\n                            initSchedule={schedule}\r\n                            initSelections={slots}\r\n                            mode={\"select\"}\r\n                            onSelect={h}\r\n                        />).then(slot => classRegister(sbj.id, slot), verifyClose)\r\n                    } else {\r\n                        subjectRegister(sbj.id);\r\n                    }\r\n                }}>Zarejestruj</Button>\r\n            </>}</span>\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction evalSlots(slots, ratings) {\r\n    const ratingVals = slots.map(s => ratings[s]).filter(r => r !== undefined).sort().reverse()\r\n    return genWeights(0.8, 1, ratingVals.length).map((w, i) => w*ratingVals[i]).reduce((r1, r2) => r1+r2) / 6\r\n}\r\n\r\nfunction genWeights(prop, val, len) {\r\n    if (len === 0) {\r\n        return [];\r\n    }\r\n    return [val*prop, ...genWeights(prop, val*(1-prop), len - 1)] \r\n}\r\n\r\nexport function getColor(val) {\r\n    return `rgb(${Math.floor(Math.min(255, (1-val)*512))}, ${Math.floor(Math.min(255, val*512))}, 0)`;\r\n}\r\n\r\nfunction sbjSet(subjects) {\r\n    if (subjects === null) {\r\n        return null;\r\n    }\r\n    const retSet = new Set();\r\n    subjects.forEach(sbj => retSet.add(sbj.id));\r\n    return retSet;\r\n}","import React from 'react';\nimport './Schedule.css';\nimport { Button } from \"./App\";\nimport { fetchClasses, pushRescheduleRequest, pushRatings, fetchRatings } from \"./Remote\";\nimport { getColor } from './Register';\nconst hours = [\"8:15\", \"10:15\", \"12:15\", \"14:15\", \"16:15\", \"18:15\"];\nconst days = [\"poniedzialek\", \"wtorek\", \"sroda\", \"czwartek\", \"piatek\"];\n\nfunction getSlotId(day, hour) {\n    return (1 + hours.indexOf(hour) + days.indexOf(day)*6).toString();\n}\n\nfunction useMousePos(inital) {\n    const [pos, setPos] = React.useState(inital);\n    React.useEffect(function() {\n        function handleMove(event) {\n            setPos({\n                x: event.pageX,\n                y: event.pageY\n            });\n        }\n        window.addEventListener(\"mousemove\", handleMove);\n        return () => window.removeEventListener(\"mousemove\", handleMove);\n    }, []);\n    return pos;\n}\n\nfunction schedStateReducer(state, { action, data }) {\n    switch (action) {\n        case \"drag\":\n            return {...state, dragged: data};\n        case \"endDrag\":\n            const { x, y, id } = data;\n            let newSched = null;\n            for (const [slot, clb] of Object.entries(state.dropSlots.current)) {\n                if (clb(x, y)) {\n                    newSched = JSON.parse(JSON.stringify(state.schedule));\n                    newSched[id].resched = slot;\n                    if (newSched[id].slot === slot) {\n                        delete newSched[id].resched;\n                    }\n                    break;\n                }\n            }\n            return {...state, dragged: null, schedule: newSched ?? state.schedule};\n        case \"toggleSelect\":\n            return {...state, selections: {...state.selections, [data]: !state.selections[data]}};\n        case \"rerate\":\n            return {...state, ratings: {...state.ratings, [data.slot]: data.rating}};\n        case \"setSchedule\":\n            return {...state, schedule: data};\n        case \"setSelections\":\n            return {...state, selections: data};\n        case \"setRatings\":\n            return {...state, ratings: data};\n        default:\n            return state;\n    }\n}\n\nfunction transformSchedule(schedule, perm, disId) {\n    if (schedule === undefined) {\n        return {};\n    }\n    const sbs = {};\n    for (const [id, cls] of Object.entries(schedule)) {\n        if (perm) {\n            id !== disId && (sbs[cls.resched ?? cls.slot] ?? (sbs[cls.resched ?? cls.slot] = [])).push(cls);\n        } else {\n            (sbs[cls.slot] ?? (sbs[cls.slot] = [])).push(cls);\n            if (cls.resched) {\n                (sbs[cls.resched] ?? (sbs[cls.resched] = [])).push({...cls, pend: true});\n            }\n        }\n    }\n    return sbs;\n}\n\nfunction reduceSelections(selections) {\n    const sel = new Set();\n    for (const [slot, selected] of Object.entries(selections)) {\n        selected && sel.add(slot);\n    }\n    return sel;\n}\n\nfunction scheduleDiff(inital, current) {\n    const changes = {};\n    for (const [id, cls] of Object.entries(current)) {\n        if ((cls.resched ?? cls.slot) !== (inital[id].resched ?? inital[id].slot)) {\n            changes[id] = cls.resched ?? cls.slot;\n        }\n    }\n    return changes;\n}\n\nexport function Schedule({ initSchedule, initRatings, initSelections, onSelect, disabledSlots, mode, actions, permResched, setDataPusher, title }) {\n    const dropSlots = React.useRef({});\n    const registerDropSlot = React.useCallback((slot, cb, unsub) => unsub ? (delete dropSlots.current[slot]) : (dropSlots.current[slot] = cb), []);\n    const borderRef = React.useRef();\n    const [{ schedule, selections, ratings, dragged }, dispatch] = React.useReducer(schedStateReducer, {\n        schedule: initSchedule,\n        selections: initSelections,\n        ratings: initRatings,\n        dragged: null,\n        dropSlots\n    });\n    React.useEffect(() => dispatch({action: \"setSchedule\", data: initSchedule}), [initSchedule]);\n    React.useEffect(() => dispatch({action: \"setSelections\", data: initSelections}), [initSelections]);\n    React.useEffect(() => dispatch({action: \"setRatings\", data: initRatings}), [initRatings]);\n    const schedBySlot = React.useMemo(() => transformSchedule(schedule, permResched, dragged?.disId), [schedule, permResched, dragged]);\n\n    const fwd = {mode, dispatch, registerDropSlot, onSelect, borderRef};\n\n    const getCbData = {\n        reschedule: () => scheduleDiff(initSchedule, schedule),\n        select: () => reduceSelections(selections),\n        rate: () => ratings\n    }[mode];\n    React.useEffect(() => setDataPusher?.(getCbData));\n\n    return (\n        <div id=\"schedule\" className=\"content-box\">\n            {title}\n            <div id=\"scheduleborder\" ref={borderRef}>\n                <ul id=\"daylist\">\n                    <li><HourLegend/></li>\n                    {days.map(function(day) {\n                        return (\n                            <li key={day}><ul className=\"daycolumn\">\n                                {day}\n                                {hours.map(function(hour) {\n                                    const slot = getSlotId(day, hour);\n                                    return <ClassBox\n                                        key={slot} \n                                        slot={slot} \n                                        cls={schedBySlot[slot]}\n                                        selected={selections?.[slot]}\n                                        rating={ratings?.[slot]}\n                                        droppable={permResched ? \"all\" : dragged?.drops.includes(slot)}\n                                        disabled={disabledSlots?.has(slot)}\n                                        {...fwd}\n                                    />\n                                })}\n                            </ul></li>\n                        );\n                    })}\n                    <li><HourLegend/></li>\n                </ul>\n            </div>\n            {dragged?.elem}\n            {actions?.map((act, i) => <Button key={i} {...(act.btProps ?? {})} onClick={() => act.cb(getCbData())}>{act.name}</Button>)}\n        </div>\n    );\n}\n\nfunction ScheduleView() {\n    const [schedule, setSchedule] = React.useState(null);\n    const [ratings, setRatings] = React.useState(null);\n    const [mode, setMode] = React.useState(\"view\");\n    React.useEffect(() => fetchClasses().then(setSchedule), []);\n    React.useEffect(() => mode === \"rate\" && fetchRatings().then(setRatings), [mode]);\n    if (schedule === null || (mode === \"rate\" && ratings === null)) {\n        return <div>Loading content...</div>;\n    }\n    const actions = [];\n    const schedProps = {actions, mode, title: \"Plan Zajęć\"};\n    if (mode === \"reschedule\") {\n        actions.push({\n            name: \"Zaporoponuj zmiany\",\n            cb: function(chng) {\n                setSchedule(null);\n                pushRescheduleRequest(chng).then(() => fetchClasses().then(setSchedule));\n            }\n        });\n    } else if (mode === \"rate\") {\n        actions.push({\n            name: \"Zapisz\",\n            cb: function(rtings) {\n                setRatings(null);\n                pushRatings(rtings).then(() => fetchRatings().then(setRatings).then(() => setMode(\"view\")));\n            }\n        });\n        schedProps.initRatings = ratings;\n    }\n    return (\n        <>\n            <Schedule initSchedule={schedule} {...schedProps}/>\n            <div>\n                <Button onClick={() => setMode(\"view\")}>Plan</Button>\n                <Button onClick={() => setMode(\"reschedule\")}>Zmiana Grup</Button>\n                <Button onClick={() => setMode(\"rate\")}>Dogodność Godzin</Button>\n            </div>\n        </>\n    )\n}\n\nfunction HourLegend() {\n    return (\n        <ul className=\"hourlegend\">\n            &nbsp;\n            {[8, 10, 12, 14, 16, 18].map(hour => <li key={hour}>{hour.toString() + \":15\"}</li>)}\n        </ul>\n    );\n}\n\nfunction ClassBox({ cls, slot, mode, dispatch, registerDropSlot, selected, onSelect, rating, droppable, disabled, borderRef }) {\n    const ref = React.useRef();\n    const fwd = {mode, dispatch, rating, borderRef};\n    React.useEffect(function() {\n        if (droppable) {\n            registerDropSlot(slot, function(x, y) {\n                const rect = ref.current.getBoundingClientRect();\n                return (y > rect.top && y < rect.bottom && x > rect.left && x < rect.right);\n            }, false);\n            return () => registerDropSlot(slot, null, true);\n        }\n    }, [slot, registerDropSlot, droppable]);\n    let cont = null;\n    if (rating !== undefined) {\n        cont = <Rater {...fwd} slot={slot} cls={cls}/>;\n    } else if (cls !== undefined && cls.length !== 0) {\n        cont = cls.length === 1 ? <Class {...fwd} cls={cls[0]}/> : <Collision {...fwd} cls={cls}/>;\n    }\n    const handlers = {};\n    if (mode === \"select\" && selected !== undefined) {\n        handlers.onClick = function() {\n            dispatch({action: \"toggleSelect\", data: slot});\n            onSelect?.(slot);\n        }\n    }\n    let clsName = \"class-box\";\n    if (droppable === true || selected) {\n        clsName = clsName.concat(disabled ? \" selected-disabled\" : \" highlight\");\n    } else if (disabled) {\n        clsName = clsName.concat(\" disabled-slot\");\n    }\n    return <li className={clsName} {...handlers} ref={ref}>{cont}</li>;\n}\n\nfunction Class(props) {\n    const width = props.width ?? 100;\n    const [{ text, prevW }, setText] = React.useState({prevW: 100});\n    React.useLayoutEffect(function() {\n        let newText;\n        if (width >= 65) {\n            newText = (<>\n                {props.cls.name}<br/>\n                {props.cls.type}<br/>\n                Sala: {props.cls.room}\n            </>);\n        } else if (width > 18) {\n            newText = <>{props.cls.name.split('').map(l => <>{l}<br/></>)}</>;\n        } else {\n            newText = <>I</>;\n        }\n        if (width > prevW) {\n            const tId = setTimeout(() => setText({text: newText, prevW: width}), 100);\n            return () => clearTimeout(tId);\n        }\n        setText({text: newText, prevW: width});\n    }, [width])\n    let handlers = {};\n    if (props.mode === \"reschedule\") {\n        handlers.onMouseDown = function(event) {\n            event.preventDefault();\n            const rect = event.currentTarget.getBoundingClientRect();\n            const offset = {\n                x: rect.x + window.scrollX - event.pageX,\n                y: rect.y + window.scrollY - event.pageY\n            }\n            props.dispatch?.({action: \"drag\", data: {\n                elem: <DraggedClass cls={props.cls} initPos={{x: event.pageX, y: event.pageY}} offset={offset} dispatch={props.dispatch} borderRef={props.borderRef}/>,\n                drops: props.cls.alts,\n                disId: props.cls.id\n            }});\n        }\n    }\n    const style = props.cls.pend ? {opacity: 0.5} : {};\n    return (<div className={props.cls.type} {...handlers} style={style}>{text}</div>);\n}\n\nfunction DraggedClass({ initPos, cls, offset: {x: ox, y: oy}, dispatch, borderRef }) {\n    const ref = React.useRef();\n    const { x, y } = useMousePos(initPos);\n    const { width, height } = ref.current?.getBoundingClientRect() ?? {width: 0, height: 0};\n    const { top: borderTop, left: borderLeft, bottom: borderBottom, right: borderRight } = borderRef.current.getBoundingClientRect();\n    const leftPos = Math.min(Math.max(x + ox, borderLeft + window.scrollX), borderRight + window.scrollX - width);\n    const topPos = Math.min(Math.max(y + oy, borderTop + window.scrollY), borderBottom + window.scrollY - height);\n    return (<div className=\"class-box dragged-class\" style={{\n        left: leftPos,\n        top: topPos\n    }} ref={ref} onMouseUp={function() {\n        console.log(\"dropped\");\n        const {top, bottom, left, right} = ref.current.getBoundingClientRect();\n        dispatch({action: \"endDrag\", data: {y: (top + bottom) / 2, x: (left + right) / 2, id: cls.id}})\n    }}>\n        <Class cls={cls}/>\n    </div>);\n}\n\nfunction Collision({ cls: clss, mode, dispatch, borderRef }) {\n    const eqWidth = 100/clss.length;\n    const fWidth = 65;\n    const ufWidth = 35/(clss.length - 1);\n    const ref = React.useRef();\n    const [focused, setFocused] = React.useState(null);\n    \n    // onMouseLeave has issues with draggables, so onMouseMove must be used\n    // onMouseLeave is still used, to handle the overflow case in \"rate\" mode\n    React.useEffect(function() {\n        function onMove(event) {\n            const { clientX: mx, clientY: my} = event;\n            const {top, bottom, left, right} = ref.current.getBoundingClientRect();\n            if (my < top || my > bottom || mx < left || mx > right) {\n                setFocused(null);\n            }\n        }\n        window.addEventListener(\"mousemove\", onMove);\n        return () => window.removeEventListener(\"mousemove\", onMove);\n    }, [])\n\n    return (\n        <div ref={ref} style={{height: \"100%\"}} onMouseLeave={() => setFocused(null)}>\n            {clss.map(function(cls, i) {\n                const width = focused === null ? eqWidth : (i === focused ? fWidth : ufWidth);\n                const fwd = {cls, width, mode, dispatch, borderRef};\n                return (\n                    <div key={i} className=\"shrunk-box\" onMouseEnter={() => setFocused(i)} style={{maxWidth: `${width}%`}}>\n                        <Class {...fwd}/>\n                    </div>\n                );\n            })}\n        </div>\n    );\n}\n\nfunction Rater({ dispatch, slot, rating, mode, cls, borderRef }) {\n    const [clsExpanded, setExpanded] = React.useState(false);\n    let cont = null;\n    if (mode !== \"rate\") {\n        cont = <div className='rating' style={{textShadow: `0 0 0.3em ${getColor(rating / 6)}`, width: \"100%\"}}>{rating}</div>;\n    } else {\n        cont = (\n            <>\n                <div className='rating' style={{textShadow: `0 0 0.3em ${getColor(rating / 6)}`}}>{rating}</div>\n                <div className='rater-button-box'>\n                    <div className='rater-button' onClick={() => dispatch({action: \"rerate\", data: {slot, rating: Math.min(6, rating + 1)}})}>+</div>\n                    <div className='rater-button' onClick={() => dispatch({action: \"rerate\", data: {slot, rating: Math.max(0, rating - 1)}})}>-</div>\n                </div>\n            </>\n        )\n    }\n    if (cls) {\n        console.log(\"need to show class\");\n        const fwd = {mode, borderRef, dispatch};\n        const clsElem = cls.length === 1 ? <Class {...fwd} cls={cls[0]}/> : <Collision {...fwd} cls={cls}/>;\n        return (<>\n            <div className='rater' style={{maxHeight: clsExpanded ? \"0\" : \"62%\"}}>\n                {cont}\n            </div>\n            <div style={{height: \"100%\"}} onClick={() => setExpanded(e => !e)} onMouseLeave={() => setExpanded(false)}>\n                {clsElem}\n            </div>\n        </>);\n    }\n    return <div className='rater'>{cont}</div>;\n}\n\nexport function expandSelection(sel) {\n    const fullSel = {};\n    Array.from(Array(30).keys()).forEach(i => {fullSel[i+1] = false});\n    return {...fullSel, ...sel};\n}\n\nexport default ScheduleView;","import React from \"react\"\nimport { Button, DispatchContext, UserContext } from \"./App\";\nimport \"./Login.css\"\nimport { login } from \"./Remote\";\n\nexport default function LogIn() {\n    const dispatch = React.useContext(DispatchContext);\n    const [nameVal, setName] = React.useState(\"\");\n    const [passVal, setPass] = React.useState(\"\");\n    function onChangeName(event) {\n        setName(event.target.value);\n    }\n    function onChangePass(event) {\n        setPass(event.target.value);\n    }\n    function onSubmit(event) {\n        event.preventDefault();\n        login(nameVal, passVal).then(un => dispatch({action: \"login\", data: un})).catch(alert);\n    }\n    return (\n        <form onSubmit={onSubmit}>\n            <input type=\"text\" name=\"name\" value={nameVal} onChange={onChangeName} required placeholder=\"Login\"/><br/>\n            <input type=\"password\" name=\"password\" value={passVal} onChange={onChangePass} required placeholder=\"Hasło\"/><br/>\n            <Button submit onClick={() => console.log(\"pressed log in\")}>Log in</Button>\n        </form>\n    );\n}\n\nexport function LogInLink() {\n    const dispatch = React.useContext(DispatchContext);\n    const user = React.useContext(UserContext);\n    if (user) {\n        return (\n            <span style={{float: \"right\"}} onClick={function() {\n                dispatch({action: \"logout\"});\n            }}>Log out</span>\n        )\n    }\n    return (\n        <span style={{float: \"right\"}} onClick={function() {\n            dispatch({action: \"setContent\", data: <LogIn/>});\n        }}>Log in</span>\n    )\n}","import React from 'react';\nimport { DispatchContext, UserContext } from \"./App\";\nimport { LogInLink } from './Login';\nimport './Nav.css';\n\n\nexport function NavLink({ children, view, nNots }) {\n    const dispatch = React.useContext(DispatchContext);\n    return (<span onClick={() => dispatch({action: \"setContent\", data: view})}>\n        {children}\n        {nNots && <div className=\"notifIndicator\">{nNots}</div>}\n    </span>);\n}\n\nfunction ShowNav({ toggle }) {\n    return <span onClick={toggle}>O</span>;\n}\n\n// function SideNav() {\n//     return (\n        \n//     )\n// }\n\nexport default function NavBar({ links, windWidth }) {\n    const [sideVisible, setSide] = React.useState(false);\n    const user = React.useContext(UserContext);\n    const prompt = <div>You must be logged in to view this content</div>;\n    if (windWidth < 500) {\n        return (\n            <nav>\n                <div style={{display: sideVisible ? \"block\" : \"none\"}}>\n                    {links.map((link, i) => <NavLink key={i} view={user ? link.view : prompt} stack={true} nNots={link.nNots}>{link.name}</NavLink>)}\n                </div>\n                <ShowNav toggle={function() {setSide(prev => !prev)}}/>\n                <LogInLink/>\n            </nav>\n        );    \n    }\n    return (\n        <nav>\n            <LogInLink/>\n            {links.map((link, i) => <NavLink key={i} view={user ? link.view : prompt} stack={false} nNots={link.nNots}>{link.name}</NavLink>)}\n        </nav>\n    );\n}\n","import React from \"react\";\nimport { NavLink } from \"./Nav\";\nimport './Courses.css';\nimport { fetchCourses, useRemoteData } from \"./Remote\";\n\nfunction getCourseText(name) {\n    return `blablabla info o ${name}`;\n}\n\nfunction CourseInfo(props) {\n    const [info, setInfo] = React.useState(\"\");\n    React.useEffect(function() {\n        setInfo(getCourseText(props.name));\n    }, [props.name]);\n    return (\n        <div>\n            <h2>{props.name}</h2>\n            {info}\n        </div>\n    )\n}\n\nfunction MaitainerInfo(props) {\n    const [info, setInfo] = React.useState(\"\");\n    React.useEffect(function() {\n        setInfo(getCourseText(props.name));\n    }, [props.name]);\n    return (\n        <div>\n            {info}\n        </div>\n    )\n}\n\nfunction CoursesList() {\n    const [courses] = useRemoteData(fetchCourses);\n    if (courses === null) {\n        return <div>Loading content...</div>;\n    }\n    return (\n        <div id=\"courses\" className=\"content-box\">\n            Moje Przedmioty\n            {courses.map(crs => <Course key={crs.id} name={crs.name}/>)}\n        </div>\n    )\n}\n\nfunction Course(props) {\n    const [expanded, setExpanded] = React.useState(false);\n    return (\n        <>\n            <div className=\"course\" onClick={function() {\n                setExpanded(prev => !prev);\n            }}>{props.name}</div>\n            <div className=\"course-menu\" style={{maxHeight: expanded ? \"3em\" : \"0px\"}}>\n                <NavLink view={<CourseInfo name={props.name}/>}>Strona przedmiotu</NavLink>\n                <NavLink view={<MaitainerInfo name={props.maitainerName}/>}>Strona prowadzącego</NavLink>\n            </div>\n        </>\n    )\n}\n\nexport default CoursesList;","import React from 'react';\r\nimport { useRemoteData, fetchGrades } from \"./Remote\";\r\nimport './Grades.css';\r\n\r\nexport default function Grades() {\r\n    const [courses] = useRemoteData(fetchGrades);\r\n    if (courses === null) {\r\n        return <div>Loading grades...</div>;\r\n    }\r\n    return (\r\n        <div className='content-box'>\r\n            Moje oceny\r\n            {courses.map(crs => <div className='box-row'>{crs.name}:<span className='grade'>{crs.grade}</span></div>)}\r\n        </div>\r\n    );\r\n}","import React from 'react';\r\nimport { Button } from './App';\r\nimport { fetchRequests, useRemoteData, approveRequest, declineRequest } from \"./Remote\";\r\nimport './ReschedRequests.css';\r\n\r\nexport default function ReschedRequests() {\r\n    const [requests, _, setRequests] = useRemoteData(fetchRequests);\r\n    const delRequest = React.useCallback(function(id) {\r\n        setRequests(reqs => reqs.filter(r => r.id !== id));\r\n    }, [setRequests])\r\n    if (requests === null) {\r\n        return <div>Loading requests...</div>;\r\n    }\r\n    return (\r\n        <div className=\"content-box\">\r\n            Prośby o zmiany grup\r\n            {requests.map(req => <RRequest key={req.id} {...req} del={delRequest}/>)}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction RRequest({ id, stud, cls, to, del }) {\r\n    const [pending, setPending] = React.useState(false);\r\n    return (\r\n        <div className=\"box-row\">\r\n            {cls.name} {cls.type}, {stud}, na {to}\r\n            <span className='resched-buttons'>{pending ? \"przetwarzanie...\" : (<><Button onClick={function() {\r\n                setPending(true);\r\n                approveRequest(id).then(() => del(id)).catch(() => setPending(false));\r\n            }}>Zaakceptuj</Button>\r\n            <Button onClick={function() {\r\n                setPending(true);\r\n                declineRequest(id).then(() => del(id)).catch(() => setPending(false));\r\n            }}>Odrzuć</Button></>)}</span>\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\nimport { Button, GroupSelector, SearchBar, usePopup, UserContext, verifyClose } from \"./App\";\r\nimport { fetchPolls, useRemoteData, removePoll, resolvePoll, votePoll, fetchPollSlots, fetchGroups, fetchIntersect, addPoll } from \"./Remote\";\r\nimport { expandSelection, Schedule } from './Schedule';\r\n\r\nexport default function Polls() {\r\n    const user = React.useContext(UserContext);\r\n    const stud = user.position === \"ROLE_STUDENT\";\r\n    const [polls, _, setPolls] = useRemoteData(fetchPolls);\r\n    const [popup, show] = usePopup();\r\n    const resolve = React.useCallback(function resolve(id) {\r\n        resolvePoll(id).then(function(res) {\r\n            const best = Object.entries(res).reduce((s1, s2) => s1[1] > s2[1] ? s1 : s2)[0]\r\n            return show(() => <Schedule\r\n                title=\"Wynik ankiety\"\r\n                initRatings={res}\r\n                initSelections={{[best]: true}}\r\n                mode=\"view\"\r\n            />)\r\n        }).catch(verifyClose);\r\n    }, []);\r\n    const vote = React.useCallback(function(id) {\r\n        fetchPollSlots(id).then(slots => show(handleData => <Schedule\r\n            initRatings={slots}\r\n            mode=\"rate\"\r\n            actions={[{\r\n                name: \"Głosuj\",\r\n                cb: handleData\r\n            }]}/>\r\n        )).then(rtngs => votePoll(id, rtngs), verifyClose);\r\n    }, []);\r\n    const add = React.useCallback(function() {\r\n        show(h => <GroupSelector onSelect={h}/>)\r\n            .then(grps => fetchIntersect(grps))\r\n            .then(slots => show(h => <SlotSelector onSelect={h} initSlots={slots}/>))\r\n            .then(({name, slots}) => addPoll(name, slots))\r\n            .then(newPoll => setPolls(pls => [...pls, newPoll]), function(err) {\r\n                if (err !== \"not added\") {\r\n                    throw err;\r\n                } else {\r\n                    alert(\"failed to add poll server side\");\r\n                }\r\n            })\r\n            .catch(verifyClose);\r\n    }, []);\r\n    const remove = React.useCallback(function(id) {\r\n        removePoll(id).then(() => setPolls(pls => pls.filter(p => p.id !== id)), () => alert(\"remove failed server side\"));\r\n    }, []);\r\n    if (polls === null) {\r\n        return <div>Loading polls...</div>;\r\n    }\r\n    return (\r\n        <>\r\n            <div className=\"content-box\">\r\n                Ankiety\r\n                {polls.map(poll => <Poll key={poll.id} {...poll} resolve={resolve} remove={remove} vote={stud ? vote : null}/>)}\r\n            </div>\r\n            {stud || <div><Button onClick={add}>Dodaj</Button></div>}\r\n            {popup}\r\n        </>\r\n    );\r\n}\r\n\r\nfunction Poll({ id, name, voted, resolve, remove, vote }) {\r\n    return (\r\n        <div className=\"box-row\">\r\n            {name}\r\n            <span className='resched-buttons'>\r\n                {vote ? <>{voted && \"Zagłosowano\"}<Button onClick={() => vote(id)}>Głosuj</Button></> :\r\n                <><Button onClick={() => resolve(id)}>Wynik</Button>\r\n                <Button onClick={() => remove(id)}>Zakończ</Button></>}\r\n            </span>\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction SlotSelector({ onSelect, initSlots }) {\r\n    const crtBtRef = React.useRef();\r\n    const [expandedSlots, disabled] = React.useMemo(function() {\r\n        const expSelect = expandSelection(initSlots);\r\n        const disabled = new Set();\r\n        Object.keys(expSelect).forEach(slot => slot in initSlots || disabled.add(slot));\r\n        return [expSelect, disabled];\r\n    }, [initSlots]);\r\n    const schedDataGetter = React.useRef(null);\r\n    const [name, setName] = React.useState(\"\");\r\n    return (\r\n        <>  \r\n            <div style={{marginBottom: \"0.5em\"}}>\r\n                <form id=\"slot-selector-form\" className=\"search-bar\" onSubmit={function(event) {\r\n                    event.preventDefault();\r\n                    onSelect({name, slots: schedDataGetter.current()});\r\n                }}>\r\n                    <div>\r\n                        <input \r\n                            type=\"text\"\r\n                            value={name}\r\n                            onChange={event => setName(event.target.value)}\r\n                            required\r\n                            placeholder=\"Wpisz nazwę\"\r\n                        />\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            <div onClick={() => crtBtRef.current?.focus()}>\r\n                <Schedule\r\n                    initSelections={expandedSlots}\r\n                    disabledSlots={disabled}\r\n                    mode=\"select\"\r\n                    setDataPusher={getter => () => schedDataGetter.current = getter}\r\n                />\r\n            </div>\r\n            <div>\r\n                <Button ref={crtBtRef} form=\"slot-selector-form\" submit>Utwórz</Button>\r\n            </div>\r\n        </>\r\n    );\r\n}","import { fetchNews, useRemoteData } from \"./Remote\";\r\nimport './News.css';\r\n\r\nexport default function News() {\r\n    const [infos] = useRemoteData(fetchNews);\r\n    if (infos === null) {\r\n        return <div>Loading news...</div>\r\n    }\r\n    return (\r\n        <div className=\"content-box\" id=\"news-box\">\r\n            Aktualności\r\n            {infos.map(info => <div className=\"box-row\">\r\n                <h3>{info.title}</h3>\r\n                <div className=\"info-box\">\r\n                    {info.text}\r\n                </div>\r\n            </div>)}\r\n        </div>\r\n    );\r\n}","import React from \"react\"\r\nimport { Button, SearchBar } from \"./App\";\r\nimport { fetchWorkerInfo, fetchWorkers, useRemoteData } from \"./Remote\";\r\n\r\nexport default function Workers() {\r\n    const [workers] = useRemoteData(fetchWorkers);\r\n    const suggestions = React.useMemo(() => workers?.map(w => w.name), [workers]);\r\n    const [searched, setSearched] = React.useState(null);\r\n    const [worker, setWorker] = React.useState(null);\r\n    if (workers === null) {\r\n        return <div>Loading workers...</div>;\r\n    }\r\n    return (\r\n        <div className=\"content-box\">\r\n            Pracownicy\r\n            <SearchBar onSearch={function(str) {\r\n                setWorker(null);\r\n                setSearched(workers.filter(w => w.name.includes(str)));\r\n            }} suggestions={suggestions}/>\r\n            {worker?.text ?? searched?.map(w => <div key={w.id} className=\"content-row\">{w.name}<Button onClick={function() {\r\n                fetchWorkerInfo(w.id).then(setWorker);\r\n            }}>Wybierz</Button></div>)}\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\nimport { GroupSelector } from \"./App\";\r\nimport { fetchGroupSchedule, pushRescheduleRequest } from './Remote';\r\nimport { Schedule } from \"./Schedule\";\r\n\r\nexport default function AdminSchedule() {\r\n    const [filteredClasses, setClasses] = React.useState(null);\r\n    const [groups, setGroups] = React.useState(null);\r\n    React.useEffect(() => groups === null || fetchGroupSchedule(groups).then(setClasses), [groups])\r\n    return (\r\n        <div className=\"content-box\">\r\n            <GroupSelector onSelect={setGroups}/>\r\n            {filteredClasses && <Schedule \r\n                initSchedule={filteredClasses}\r\n                permResched\r\n                mode={\"reschedule\"}\r\n                actions={[{\r\n                    name: \"Zmień\",\r\n                    cb: function(chng) {\r\n                        setClasses(null);\r\n                        pushRescheduleRequest(chng)\r\n                            .then(() => fetchGroupSchedule(groups)\r\n                            .then(setClasses));\r\n                    }\r\n                }]}\r\n            />}\r\n        </div>\r\n    )\r\n}","import React from 'react';\nimport ScheduleView from './Schedule';\nimport LogIn from './Login';\nimport NavBar from './Nav';\nimport CoursesList from './Courses';\nimport './App.css';\nimport Grades from './Grades';\nimport ReschedRequests from './ReschedRequests';\nimport Register from './Register';\nimport Polls from './Polls';\nimport News from './News';\nimport Workers from './Workers';\nimport { fetchGroups, useRemoteData } from './Remote';\nimport AdminSchedule from './AdminSchedule';\n\nexport const UserContext = React.createContext();\nexport const DispatchContext = React.createContext();\n\nfunction stateReducer(state, { action, data }) {\n    switch (action) {\n        case \"resize\":\n            return {...state, width: window.innerWidth};\n        case \"login\":\n            return {...state, user: data, content: <News/>};\n        case \"logout\":\n            return {...state, user: null, content: <LogIn/>};\n        case \"setContent\":\n            return {...state, content: data};\n    }\n}\n\nexport default function App() {\n    const [{ content, user, width }, dispatch] = React.useReducer(stateReducer, {\n        content: <LogIn/>,\n        user: null,\n        width: window.innerWidth\n    });\n\n    React.useEffect(function() {\n        let updateWidth = () => dispatch({action: \"resize\"});\n        window.addEventListener(\"resize\", updateWidth);     \n        return () => window.removeEventListener(\"resize\", updateWidth);\n    }, []);\n\n    // React.useEffect(function() {\n    //     const intt = setInterval(() => console.log(document.activeElement), 500);\n    //     return () => clearInterval(intt);\n    // }, []);\n\n    const links = [\n        {name: \"Plan zajęć\", view: <ScheduleView/>},\n        {name: \"Ankiety\", view: <Polls/>, nNots: user ? 10 : undefined},\n        {name: \"Aktualności\", view: <News/>},\n        {name: \"Pracownicy\", view: <Workers/>},\n    ];\n    const showAll = true;\n    if (user) {\n        if (user.position === \"ROLE_STUDENT\" || showAll) {\n        links.push(...[\n        {name: \"Oceny\", view: <Grades/>},\n        {name: \"Przedmioty\", view: <CoursesList/>},\n        {name: \"Rejestracja\", view: <Register/>},\n        ]);\n        } else {\n            links.push({name: \"Zmiany grup\", view: <ReschedRequests/>, nNots: user ? 3 : undefined});\n        }\n        if (showAll) {\n            links.push({name: \"Zmiany grup\", view: <ReschedRequests/>, nNots: user ? 3 : undefined});\n        }\n        if (user.security === \"ROLE_ADMIN\" || showAll) {\n            links.push({name: \"Plan\", view: <AdminSchedule/>});\n        }\n    }\n\n    return (\n        <DispatchContext.Provider value={dispatch}>\n        <UserContext.Provider value={user}>\n            <NavBar links={links} windWidth={width}/>\n            <ContentBox>\n                {content}\n            </ContentBox>\n            <Footer/>\n        </UserContext.Provider>\n        </DispatchContext.Provider>\n    );\n}\n\nfunction ContentBox({ children }) {\n    return (\n        <div id=\"content\">\n            <div>\n                {children}\n            </div>\n        </div>\n    );\n}\n\nexport const Button = React.forwardRef(function({ onClick, children, submit, style, autofocus, form }, ref) {\n    const [clicked, setClicked] = React.useState(false);\n    React.useEffect(() => autofocus && ref.current.focus(), []);\n    return (\n        <button \n            className={\"button\" + (clicked ? \" button-clicked\" : \"\")} \n            onClick={onClick}\n            onMouseDown={() => setClicked(true)}\n            onMouseUp={() => setClicked(false)}\n            onMouseLeave={() => setClicked(false)}\n            type={submit ? \"submit\" : \"\"}\n            style={style}\n            ref={ref}\n            {...(form ? {form} : {})}\n        >\n            <div className=\"bdummy\">{children}</div>\n            <div className={\"btext\"  + (clicked ? \" btext-clicked\" : \"\")}>{children}</div>\n        </button>\n    )\n})\n\nexport function SearchBar({ onSearch, suggestions, searchOnSelect }) {\n    const [searchVal, setVal] = React.useState(\"\");\n    const [focused, setFocused] = React.useState(false);\n    const [focusedSugg, setFocusedSugg] = React.useState(null);\n    const [showSugg, setShowSugg] = React.useState(true);\n    const fltrSuggerstions = React.useMemo(() => suggestions\n        ?.filter(sug => sug.includes(searchVal)),\n    [suggestions, searchVal])\n    return (\n        <form onSubmit={function(event) {\n            event.preventDefault();\n            onSearch(searchVal);\n        }} autoComplete='off'>\n            <div  className=\"search-bar\">\n                <input\n                    type=\"text\"\n                    name=\"name\"\n                    value={searchVal}\n                    onChange={function(event) {\n                        setFocusedSugg(null);\n                        setVal(event.target.value);\n                        setShowSugg(true);\n                    }}\n                    onFocus={() => setFocused(true)}\n                    onBlur={() => setFocused(false)}\n                    onKeyDown={function(event) {\n                        switch(event.key) {\n                            case \"ArrowDown\":\n                                setFocusedSugg(i => Math.min((i ?? -1) + 1, fltrSuggerstions.length - 1));\n                                break;\n                            case \"ArrowUp\":\n                                setFocusedSugg(i => i === null || i === 0 ? null : i - 1);\n                                break;\n                            case \"Enter\":\n                                if (focusedSugg !== null) {\n                                    event.preventDefault();\n                                    const sug = fltrSuggerstions[focusedSugg];\n                                    setVal(sug);\n                                    setFocusedSugg(null);\n                                    setShowSugg(false);\n                                    searchOnSelect && onSearch(sug);\n                                }\n                        }\n                    }}\n                    required\n                    placeholder=\"Szukaj po nazwie\"\n                />\n                {focused && fltrSuggerstions && showSugg && (\n                    <div className=\"suggestions\">\n                        {fltrSuggerstions.map((sug, i) => <div key={i}\n                            className={\"suggestion\" + (i === focusedSugg ? \" focused-sugg\" : \"\")}\n                            onMouseDown={function() {\n                                setVal(sug);\n                                setFocusedSugg(null);\n                                setShowSugg(false);\n                                searchOnSelect && onSearch(sug);\n                            }}\n                        >{sug}</div>)}\n                    </div>\n                )}\n            </div>\n            <Button submit>Szukaj</Button>\n        </form>\n    );\n}\n\nfunction Footer() {\n    return (\n        <div id=\"footer\">\n            Studia 4 PAP-Z223\n        </div>\n    );\n}\n\nexport function usePopup() {\n    const rejector = React.useRef(null);\n    const [currElem, setElem] = React.useState(null);\n    React.useEffect(() => () => rejector.current?.(), []);\n    return [currElem, function(elemGetter) {\n        return new Promise(function(resolve, reject) {\n            rejector.current = reject;\n            function close() {\n                setElem(null);\n                reject(\"popup closed\");\n            }\n            setElem(\n                <div className='pop-up-container' onClick={event => event.target === event.currentTarget && close()}>\n                    <div className='pop-up'>\n                        <div className='button-div'>\n                            <Button onClick={close}>X</Button>\n                        </div>\n                        {elemGetter(function(data) {\n                            setElem(null);\n                            resolve(data);\n                        })}\n                    </div>\n                </div>\n            );\n        })\n    }]\n}\n\nexport function GroupSelector({ onSelect }) {\n    const buttonRef = React.useRef();\n    const [allGroups] = useRemoteData(fetchGroups);\n    const [groups, setGroups] = React.useState([]);\n    const groupNames = React.useMemo(() => allGroups?.map(gr => gr.name), [allGroups]);\n    if (allGroups === null) {\n        return <div>Loading...</div>;\n    }\n    return (\n        <div className='group-selector'>\n            <SearchBar searchOnSelect onSearch={function(searchVal) {\n                const newGroups = [];\n                allGroups.forEach(function(grp) {\n                    if (grp.name.includes(searchVal)) {\n                        groups.includes(grp) || newGroups.push(grp);\n                    }\n                });\n                setGroups(g => [...g, ...newGroups]);\n                buttonRef.current?.focus();\n            }} suggestions={groupNames}/>\n            {groups.map(grp => <div key={grp.id}>{grp.name}<Button onClick={function() {\n                setGroups(function(g) {\n                    const cp = [...g];\n                    cp.splice(g.indexOf(grp), 1)\n                    return cp;\n                });\n            }}>X</Button></div>)}\n            {groups.length === 0 || <Button onClick={() => onSelect(groups)} ref={buttonRef} autofocus>Wybierz</Button>}\n        </div>\n    )\n}\n\nexport function verifyClose(err) {\n    if (err !== \"popup closed\") {\n        throw err;\n    }\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}
{"version":3,"sources":["Remote.js","Register.js","Schedule.js","Login.js","Nav.js","Courses.js","Grades.js","ReschedRequests.js","Polls.js","News.js","Workers.js","AdminSchedule.js","App.js","reportWebVitals.js","index.js"],"names":["pageAt","document","location","host","ServerError","response","name","Error","ClientError","AuthenticationError","message","verifyResponse","status","useRemoteData","fetcher","required","dispatch","React","useContext","DispatchContext","useState","undefined","data","setData","refresh","useCallback","then","err","action","useEffect","username","passowrd","a","loginData","FormData","append","fetch","method","body","fetchUser","Promise","r","setTimeout","security","position","res","json","fetchCourses","id","fetchClasses","alts","slot","room","type","Math","floor","random","clsId","url","URL","searchParams","classes","schedObj","forEach","roomNumber","class_type","timeSlotID","requestedTimeSlotID","toString","resched","alternatives","map","classID","fetchRatings","ratingsObj","rating","pushRescheduleRequest","changes","console","log","froms","tos","Object","entries","from","to","push","slots","ratings","resolve","reject","addPoll","groups","Date","getTime","Array","gr","poll","pollID","pollName","sbjId","fetchCoursesRegister","slotRts","rObj","s","slotId","rts","keys","values","fetchGrades","user","grade","fetchRequests","cls","stud","fetchPolls","polls","fetchGroups","fetchIntersect","grp","slt","fetchGroupSchedule","fetchNews","title","text","fetchWorkers","Register","allSubjects","mySubjects","schedule","usePopup","popup","show","currSubjects","setSubjects","registeredSubjects","useMemo","subjects","retSet","Set","sbj","add","sbjSet","fwd","className","SearchBar","onSearch","srch","filter","sub","includes","Button","onClick","SubjectRegister","alReg","has","style","backgroundColor","getColor","evalSlots","h","initSchedule","initSelections","mode","onSelect","classRegister","verifyClose","subjectRegister","catch","ratingVals","sort","reverse","genWeights","length","w","i","reduce","r1","r2","prop","val","len","min","hours","days","getSlotId","day","hour","indexOf","getSlotName","schedStateReducer","state","dragged","x","y","pNewSched","dropSlots","current","clb","JSON","parse","stringify","permResched","drops","newSched","selections","shitf","max","Schedule","initRatings","disabledSlots","actions","setDataPusher","useRef","swipeX","windWith","WidthContext","registerDropSlot","cb","unsub","borderRef","useReducer","shift","schedBySlot","perm","disId","sbs","pend","transformSchedule","getCbData","reschedule","inital","toSlot","scheduleDiff","select","sel","reduceSelections","rate","overflow","minWidth","ref","onPointerDown","event","clientX","onPointerCancel","onPointerUp","HourLegend","opacity","transform","ClassBox","selected","droppable","disabled","elem","act","btProps","rect","getBoundingClientRect","top","bottom","left","right","cont","Rater","Class","Collision","handlers","clsName","concat","props","width","prevW","setText","useLayoutEffect","newText","split","l","tId","clearTimeout","onMouseDown","preventDefault","currentTarget","offset","window","scrollX","pageX","scrollY","pageY","DraggedClass","initPos","alt","ox","oy","pos","setPos","handleMove","addEventListener","removeEventListener","useMousePos","height","borderTop","borderLeft","borderBottom","borderRight","leftPos","topPos","onMouseUp","clss","eqWidth","ufWidth","focused","setFocused","onMove","mx","my","clientY","onMouseLeave","onMouseEnter","maxWidth","clsExpanded","setExpanded","textShadow","clsElem","maxHeight","e","ScheduleView","setMode","hasAlts","setSchedule","refreshRts","setRatings","sched","schedProps","chng","rtings","pushRatings","LogIn","nameVal","setName","passVal","setPass","invalidCred","setInvalidCred","onSubmit","login","value","onChange","target","placeholder","submit","LogInLink","float","NavLink","children","view","nNots","NavBar","links","windWidth","sideVisible","setSide","prompt","link","stack","prev","getCourseText","CourseInfo","info","setInfo","MaitainerInfo","Course","expanded","maitainerName","CoursesList","courses","crs","Grades","ReschedRequests","requests","setRequests","delRequest","reqs","req","RRequest","del","pending","setPending","approveRequest","declineRequest","Polls","setPolls","resolvePoll","best","s1","s2","vote","fetchPollSlots","handleData","rtngs","votePoll","GroupSelector","grps","SlotSelector","initSlots","newSlots","newPoll","pls","remove","removePoll","p","Poll","voted","crtBtRef","expSelect","fullSel","expandSelection","expandedSlots","schedDataGetter","marginBottom","focus","preventScroll","getter","form","News","infos","display","Workers","workers","suggestions","searched","setSearched","worker","setWorker","str","fetchWorkerInfo","AdminSchedule","filteredClasses","setClasses","setGroups","createContext","stateReducer","innerWidth","content","App","updateWidth","logevent","Provider","ContentBox","Popup","close","Footer","forwardRef","autofocus","clicked","setClicked","searchOnSelect","searchVal","setVal","focusedSugg","setFocusedSugg","showSugg","setShowSugg","fltrSuggerstions","sug","autoComplete","onFocus","onBlur","onKeyDown","key","rejector","currElem","setElem","elemGetter","buttonRef","allGroups","groupNames","newGroups","g","cp","splice","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.32bfe49e.chunk.js","sourcesContent":["import React from 'react';\r\nimport { DispatchContext } from './App';\r\nconst dummyData = true;\r\nconst pageAt = \"http://\" + document.location.host;\r\n\r\nclass ServerError extends Error {\r\n    constructor(response) {\r\n        super(\"An error on the server prevented fetching resources\");\r\n        this.name = \"ServerError\";\r\n        this.response = response;\r\n    }\r\n}\r\n\r\nclass ClientError extends Error {\r\n    constructor(response) {\r\n        super(\"A problem with the page's request prevented fetching resources\");\r\n        this.name = \"ClientError\";\r\n        this.response = response;\r\n    }\r\n}\r\n\r\nclass AuthenticationError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = \"AuthenticationError\";\r\n    }\r\n}\r\n\r\nfunction verifyResponse(response) {\r\n    if (response.status < 400) {\r\n        return null;\r\n    }\r\n    if (response.status === 401) {\r\n        throw new AuthenticationError(\"Not logged in\");\r\n    }\r\n    if (response.status < 500) {\r\n        throw new ClientError(response);\r\n    }\r\n    throw new ServerError(response)\r\n}\r\n\r\nexport function useRemoteData(fetcher, required) {\r\n    const dispatch = React.useContext(DispatchContext);\r\n    const [data, setData] = React.useState(undefined);\r\n    const refresh = React.useCallback(function() {\r\n        setData(undefined);\r\n        fetcher().then(setData, err => dispatch({action: \"error\", data: err}));\r\n    }, [fetcher, dispatch])\r\n    React.useEffect(() => (required ?? true) && data === undefined && refresh(), [refresh, required, data]);\r\n    return [data, refresh, setData];\r\n}\r\n\r\n// there are two different login requests here because we did not\r\n// manage to alter the default behaviour of SpringSecurity responses\r\nexport async function login(username, passowrd) {\r\n    const loginData = new FormData();\r\n    loginData.append(\"username\", username);\r\n    loginData.append(\"password\", passowrd);\r\n    await fetch(pageAt + \"/login\", {method: 'POST', body: loginData});\r\n    return null;\r\n}\r\n\r\nexport async function fetchUser() {\r\n    if (dummyData) {\r\n        return new Promise(r => setTimeout(() => r({username: \"default\", security: \"ROLE_ADMIN\", position: \"ROLE_STUDENT\"}), 500));\r\n    }\r\n    const res = await fetch(pageAt + \"/logged\");\r\n    if (res.status === 401) {\r\n        return false;\r\n    }\r\n    verifyResponse(res);\r\n    return await res.json();\r\n}\r\n\r\nexport async function fetchCourses() {\r\n    if (dummyData) {\r\n        return [\r\n            {\r\n                name: \"WSI\",\r\n                id: \"0\"\r\n            },\r\n            {\r\n                name: \"pap\",\r\n                id: \"1\"\r\n            }\r\n        ]\r\n    }\r\n    const res = await fetch(pageAt + \"/courses\");\r\n    verifyResponse(res);\r\n    return await res.json();\r\n}\r\n\r\nexport async function fetchClasses(alts) {\r\n    if (dummyData) {\r\n        return {\r\n            0: {\r\n                name: \"WSI\",\r\n                slot: \"2\",\r\n                room: \"98\",\r\n                id: \"0\",\r\n                type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n                alts: [{id: \"2\", clsId: \"0\"}, {id: \"29\", clsId: \"8\"}]\r\n            },\r\n            1: {\r\n                name: \"SI\",\r\n                slot: \"2\",\r\n                room: \"98\",\r\n                id: \"1\",\r\n                type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n                alts: []\r\n            },\r\n            2: {\r\n                name: \"Wsi\",\r\n                slot: \"2\",\r\n                room: \"11\",\r\n                id: \"2\",\r\n                type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n                alts: []\r\n            },\r\n            3: {\r\n                name: \"nji\",\r\n                slot: \"26\",\r\n                room: \"98\",\r\n                id: \"3\",\r\n                type: \"Laboratorium\",\r\n                alts: []\r\n            }\r\n        };\r\n    }\r\n    const url = new URL(pageAt + \"/classes\");\r\n    alts && url.searchParams.append(\"flag\", \"alts\");\r\n    const res = await fetch(url);\r\n    verifyResponse(res);\r\n    const classes = await res.json();\r\n    const schedObj = {};\r\n    classes.forEach(({ name, id, roomNumber, class_type, timeSlotID, requestedTimeSlotID }) => schedObj[id] = {\r\n        name,\r\n        id,\r\n        room: roomNumber,\r\n        type: class_type,\r\n        slot: timeSlotID.toString(),\r\n        resched: requestedTimeSlotID\r\n    });\r\n    if (alts) {\r\n        classes.forEach(({ id, alternatives }) => schedObj[id].alts = alternatives.map(({ timeSlotID, classID }) => ({id: timeSlotID, clsId: classID})));\r\n    }\r\n    return schedObj;\r\n}\r\n\r\nexport async function fetchRatings() {\r\n    if (dummyData) {\r\n        return ({\r\n            \"2\": 0,\r\n            \"26\": 2,\r\n            \"1\": 2,\r\n        });\r\n    }\r\n    const res = await fetch(pageAt + \"/ratings\");\r\n    verifyResponse(res);\r\n    const ratingsObj = {};\r\n    (await res.json()).forEach(({ timeSlotID, rating }) => {ratingsObj[timeSlotID] = rating})\r\n    return ratingsObj;\r\n}\r\n\r\nexport async function pushRescheduleRequest(changes) {\r\n    if (dummyData) {\r\n        console.log(changes);\r\n        return true;\r\n    }\r\n    const data = new FormData();\r\n    const froms = [];\r\n    const tos = []\r\n    for (const [from, to] of Object.entries(changes)) {\r\n        froms.push(from);\r\n        tos.push(to);\r\n    }\r\n    data.append(\"froms\", froms);\r\n    data.append(\"tos\", tos);\r\n    const res = await fetch(pageAt + \"/add-reschedule\", {method: 'POST', body: data});\r\n    verifyResponse(res);\r\n    return true;\r\n}\r\n\r\nexport async function pushRatings(ratingsObj) {\r\n    if (dummyData) {\r\n        return true;\r\n    }\r\n    const data = new FormData();\r\n    const slots = [];\r\n    const ratings = []\r\n    for (const [slot, rating] of Object.entries(ratingsObj)) {\r\n        slots.push(slot);\r\n        ratings.push(rating);\r\n    }\r\n    data.append(\"slotIDs\", slots);\r\n    data.append(\"ratings\", ratings);\r\n    const res = await fetch(pageAt + \"/add-ratings\", {method: 'POST', body: data});\r\n    verifyResponse(res);\r\n    return true;\r\n}\r\n\r\nexport async function approveRequest(id) {\r\n    console.log(id);\r\n    return new Promise(resolve => setTimeout(() => resolve(true), 2000));\r\n}\r\n\r\nexport async function declineRequest(id) {\r\n    console.log(id);\r\n    return new Promise((resolve, reject) => setTimeout(() => reject(new ServerError(null)), 2000));\r\n}\r\n\r\nexport async function removePoll(id) {\r\n    if (dummyData) {\r\n        return true;\r\n    }\r\n    const data = new FormData();\r\n    data.append(\"pollID\", id);\r\n    const res = await fetch(pageAt + \"/delete-poll\", {method: 'POST', body: data});\r\n    verifyResponse(res);\r\n    return true;\r\n}\r\n\r\nexport async function addPoll(name, slots, groups) {\r\n    if (dummyData) {\r\n        return {\r\n            id: (new Date()).getTime(),\r\n            name\r\n        };\r\n    }\r\n    const data = new FormData();\r\n    data.append(\"name\", name);\r\n    data.append(\"slots\", Array.from(slots));\r\n    data.append(\"classIDs\", groups.map(gr => gr.id));\r\n    const res = await fetch(pageAt + \"/add-poll\", {method: 'POST', body: data});\r\n    verifyResponse(res);\r\n    const poll = await res.json();\r\n    return {id: poll.pollID, name: poll.pollName};\r\n}\r\n\r\nexport async function subjectRegister(id) {\r\n    return true;\r\n}\r\n\r\nexport async function classRegister(sbjId, slot) {\r\n    return true;\r\n}\r\n\r\nexport async function fetchCoursesRegister() {\r\n    return [{\r\n        name: \"WSI\",\r\n        id: \"0\",\r\n    },\r\n    {\r\n        name: \"SOI\",\r\n        id: \"2\",\r\n        slots: [1, 2, 5]\r\n    },\r\n    {\r\n        name: \"PAP\",\r\n        id: \"3\",\r\n    },\r\n    {\r\n        name: \"PROB\",\r\n        id: \"4\",\r\n    }];\r\n}\r\n\r\nexport async function resolvePoll(id) {\r\n    if (dummyData) {\r\n        return {\r\n            \"2\": 13,\r\n            \"15\": 10,\r\n        }\r\n    }\r\n    const url = new URL(pageAt + \"/poll-result\");\r\n    url.searchParams.append(\"pollID\", id);\r\n    const res = await fetch(url);\r\n    verifyResponse(res);\r\n    const slotRts = await res.json();\r\n    const rObj = {};\r\n    slotRts.forEach(s => rObj[s.slotId] = s.rating);\r\n    return rObj;\r\n}\r\n\r\nexport async function votePoll(id, rts) {\r\n    if (dummyData) {\r\n        return true;\r\n    }\r\n    const data = new FormData();\r\n    data.append(\"pollId\", id);\r\n    data.append(\"slotIds\", Object.keys(rts));\r\n    data.append(\"ratings\", Object.values(rts));\r\n    const res = await fetch(pageAt + \"/vote-poll\", {method: 'POST', body: data});\r\n    verifyResponse(res);\r\n    return true;\r\n}\r\n\r\nexport async function fetchGrades(user) {\r\n    return ([{\r\n        name: \"WSI\",\r\n        grade: 3\r\n    },\r\n    {\r\n        name: \"SOI\",\r\n        grade: -10\r\n    }\r\n    ])\r\n}\r\n\r\nexport async function fetchRequests(user) {\r\n    return ([{\r\n        id: \"0\",\r\n        cls: {\r\n            name: \"WSI\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        stud: \"Jeremi Sobierski\",\r\n        to: \"3\"\r\n    },\r\n    {\r\n        id: \"1\",\r\n        cls: {\r\n            name: \"SOI\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        stud: \"Karol Orzechowski\",\r\n        to: \"25\"\r\n    }\r\n    ])\r\n}\r\n\r\nexport async function fetchPolls() {\r\n    if (dummyData) {\r\n        return ([{\r\n            name: \"ankk\",\r\n            id: \"0\"\r\n        },\r\n        {\r\n            name: \"yyyy\",\r\n            id: \"1\"\r\n        }\r\n        ])\r\n    }\r\n    const res = await fetch(pageAt + \"/polls\");\r\n    verifyResponse(res);\r\n    const polls = await res.json();\r\n    return polls.map(({ pollName, pollID }) => ({name: pollName, id: pollID}));\r\n}\r\n\r\nexport async function fetchGroups() {\r\n    if (dummyData) {\r\n        return ([{\r\n            name: \"WSI\",\r\n            id: \"0\",\r\n        },\r\n        {\r\n            name: \"SOI - lab\",\r\n            id: \"1\",\r\n        },\r\n        {\r\n            name: \"Grupa I2\",\r\n            id: \"0\",\r\n        }\r\n        ]);\r\n    }\r\n    const url = new URL(pageAt + \"/classes\")\r\n    url.searchParams.append(\"flag\", \"all\");\r\n    const res = await fetch(url);\r\n    verifyResponse(res);\r\n    return (await res.json()).map(({ name, id, class_type }) => ({name: (name + \" \" + class_type), id}));\r\n}\r\n\r\nexport async function fetchIntersect(groups) {\r\n    if (dummyData) {\r\n        return ({\r\n            \"8\": true,\r\n            \"12\": true,\r\n        });\r\n    }\r\n    const data = new FormData();\r\n    data.append(\"classIDs\", groups.map(grp => grp.id));\r\n    const res = await fetch(pageAt + \"/intersect\", {method: 'POST', body: data});\r\n    verifyResponse(res);\r\n    const slots = {};\r\n    (await res.json()).forEach(slt => slots[slt] = true);\r\n    return slots;\r\n}\r\n\r\nexport async function fetchGroupSchedule(groups) {\r\n    return {\r\n        0: {\r\n            name: \"WSI\",\r\n            slot: \"2\",\r\n            room: \"98\",\r\n            id: \"0\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        1: {\r\n            name: \"SI\",\r\n            slot: \"2\",\r\n            room: \"98\",\r\n            id: \"1\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        2: {\r\n            name: \"Wsi\",\r\n            slot: \"2\",\r\n            room: \"11\",\r\n            id: \"2\",\r\n            type: [\"Laboratorium\", \"Cwiczenia\", \"Wyklad\"][Math.floor(Math.random()*3)],\r\n        },\r\n        3: {\r\n            name: \"nji\",\r\n            slot: \"10\",\r\n            room: \"98\",\r\n            id: \"3\",\r\n            type: \"Laboratorium\",\r\n        }\r\n    };\r\n}\r\n\r\nexport async function fetchPollSlots(id) {\r\n    return {\"0\": 3, \"22\": 4};\r\n}\r\n\r\nexport async function fetchNews() {\r\n    return [\r\n        {\r\n            title: \"Som news\",\r\n            text: \"yyyyyyysapidfj aijsd 0iasj d0asdjo asj\"\r\n        },\r\n        {\r\n            title: \"Hee\",\r\n            text: \"0aijsdiwef0u82hgfy23h8irj1jkfi0owshdfsgbfhidb\"\r\n        }\r\n    ]\r\n}\r\n\r\nexport async function fetchWorkers() {\r\n    return [\r\n        {\r\n            name: \"Ewa S.\",\r\n            id: \"0\"\r\n        },\r\n        {\r\n            name: \"Peter Gawkuu\",\r\n            id: \"1\"\r\n        }\r\n    ];\r\n}\r\n\r\nexport async function fetchWorkerInfo(id) {\r\n    return {\r\n        text: \"Jakieś info o panu pracowniku\"\r\n    };\r\n}","import React from 'react';\r\nimport { Button, DispatchContext, SearchBar, usePopup, verifyClose } from \"./App\";\r\nimport { classRegister, fetchClasses, fetchCourses, fetchCoursesRegister, fetchRatings, subjectRegister, useRemoteData } from \"./Remote\";\r\nimport { Schedule } from './Schedule';\r\nimport './Register.css';\r\n\r\nexport default function Register() {\r\n    const [allSubjects] = useRemoteData(fetchCoursesRegister);\r\n    const [mySubjects] = useRemoteData(fetchCourses);\r\n    const [schedule] = useRemoteData(fetchClasses);\r\n    const [ratings] = useRemoteData(fetchRatings);\r\n    const [popup, show] = usePopup();\r\n    const [currSubjects, setSubjects] = React.useState(null);\r\n    const registeredSubjects = React.useMemo(() => sbjSet(mySubjects), [mySubjects]);\r\n    if (allSubjects === undefined || registeredSubjects === undefined || ratings === undefined) {\r\n        return <div>Loading subjects...</div>;\r\n    }\r\n    const fwd = {show, schedule, ratings};\r\n    const subjects = currSubjects ?? allSubjects;\r\n    return (<>\r\n        <div className=\"content-box\">\r\n            Rejestracja\r\n            <SearchBar onSearch={srch => setSubjects(allSubjects.filter(sub => sub.name.includes(srch)))}/>\r\n            {currSubjects !== null && <Button onClick={() => setSubjects(null)}>Wyczyść</Button>}\r\n            {subjects.map(sbj => <SubjectRegister sbj={sbj} alReg={registeredSubjects.has(sbj.id)} {...fwd}/>)}\r\n        </div>\r\n        {popup}\r\n    </>);\r\n}\r\n\r\nfunction SubjectRegister({ sbj, ratings, alReg, show, schedule }) {\r\n    const dispatch = React.useContext(DispatchContext);\r\n    const slots = React.useMemo(function() {\r\n        if (sbj.slots === undefined) {\r\n            return undefined;\r\n        }\r\n        const slots = {};\r\n        sbj.slots.forEach(slt => slots[slt] = true);\r\n        return slots;\r\n    }, [sbj])\r\n    return (\r\n        <div className=\"box-row\">\r\n            <div>{sbj.name}</div>\r\n            {alReg ? <div className='resched-side-text'>Zarejestrowano</div> : <div>\r\n                {slots && <div className=\"indicator\" style={{backgroundColor: getColor(evalSlots(sbj.slots, ratings))}}/>}  \r\n                <Button onClick={function() {\r\n                    (slots ? show(h => <Schedule\r\n                        title=\"Wybierz termin\"\r\n                        initSchedule={schedule}\r\n                        initSelections={slots}\r\n                        mode={\"select\"}\r\n                        onSelect={h}\r\n                    />).then(slot => classRegister(sbj.id, slot), verifyClose) : subjectRegister(sbj.id))\r\n                        .catch(err => dispatch({action: \"popupError\", data: err}));\r\n                }}>Zarejestruj</Button>\r\n            </div>}\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction evalSlots(slots, ratings) {\r\n    const ratingVals = slots.map(s => ratings[s]).filter(r => r !== undefined).sort().reverse()\r\n    return genWeights(0.8, 1, ratingVals.length).map((w, i) => w*ratingVals[i]).reduce((r1, r2) => r1+r2) / 6\r\n}\r\n\r\nfunction genWeights(prop, val, len) {\r\n    if (len === 0) {\r\n        return [];\r\n    }\r\n    return [val*prop, ...genWeights(prop, val*(1-prop), len - 1)] \r\n}\r\n\r\nexport function getColor(val) {\r\n    return `rgb(${Math.floor(Math.min(255, (1-val)*512))}, ${Math.floor(Math.min(255, val*512))}, 0)`;\r\n}\r\n\r\nfunction sbjSet(subjects) {\r\n    if (subjects === undefined) {\r\n        return undefined;\r\n    }\r\n    const retSet = new Set();\r\n    subjects.forEach(sbj => retSet.add(sbj.id));\r\n    return retSet;\r\n}","import React from 'react';\nimport './Schedule.css';\nimport { Button, DispatchContext, WidthContext } from \"./App\";\nimport { fetchClasses, pushRescheduleRequest, pushRatings, fetchRatings, useRemoteData } from \"./Remote\";\nimport { getColor } from './Register';\nconst hours = [\"8:15\", \"10:15\", \"12:15\", \"14:15\", \"16:15\", \"18:15\"];\nconst days = [\"poniedzialek\", \"wtorek\", \"sroda\", \"czwartek\", \"piatek\"];\n\nfunction getSlotId(day, hour) {\n    return (1 + hours.indexOf(hour) + days.indexOf(day)*6).toString();\n}\n\nexport function getSlotName(id) {\n    return days[Math.floor((id-1) / 6)] + \" \" + hours[(id-1) % 6];\n}\n\nfunction useMousePos(inital) {\n    const [pos, setPos] = React.useState(inital);\n    React.useEffect(function() {\n        function handleMove(event) {\n            setPos({\n                x: event.pageX,\n                y: event.pageY\n            });\n        }\n        window.addEventListener(\"mousemove\", handleMove);\n        return () => window.removeEventListener(\"mousemove\", handleMove);\n    }, []);\n    return pos;\n}\n\nfunction schedStateReducer(state, { action, data }) {\n    switch (action) {\n        case \"drag\":\n            return {...state, dragged: data};\n        case \"endDrag\":\n            const { x, y, id } = data;\n            let pNewSched = null;\n            for (const [slot, clb] of Object.entries(state.dropSlots.current)) {\n                if (clb(x, y)) {\n                    pNewSched = JSON.parse(JSON.stringify(state.schedule));\n                    pNewSched[id].resched = slot;\n                    if (pNewSched[id].slot === slot) {\n                        delete pNewSched[id].resched;\n                    }\n                    break;\n                }\n            }\n            return {...state, dragged: null, schedule: pNewSched ?? state.schedule};\n        case \"resched\":\n            if (!(state.permResched || state.dragged?.drops.includes(data))) {\n                return {...state, dragged: null};\n            }\n            const newSched = JSON.parse(JSON.stringify(state.schedule));\n            newSched[state.dragged.id].resched = data;\n            if (newSched[state.dragged.id].slot === data) {\n                delete newSched[state.dragged.id].resched;\n            }\n            return {...state, dragged: null, schedule: newSched};\n        case \"toggleSelect\":\n            return {...state, selections: {...state.selections, [data]: !state.selections[data]}};\n        case \"rerate\":\n            return {...state, ratings: {...state.ratings, [data.slot]: data.rating}};\n        case \"setSchedule\":\n            return {...state, schedule: data};\n        case \"setSelections\":\n            return {...state, selections: data};\n        case \"setRatings\":\n            return {...state, ratings: data};\n        case \"shift\":\n            return {...state, shitf: Math.min(Math.max(state.shitf + data, 0), 4)}\n        default:\n            return state;\n    }\n}\n\nfunction transformSchedule(schedule, perm, disId) {\n    if (schedule === undefined) {\n        return {};\n    }\n    const sbs = {};\n    for (const [id, cls] of Object.entries(schedule)) {\n        if (perm) {\n            id !== disId && (sbs[cls.resched ?? cls.slot] ?? (sbs[cls.resched ?? cls.slot] = [])).push(cls);\n        } else {\n            (sbs[cls.slot] ?? (sbs[cls.slot] = [])).push(cls);\n            if (cls.resched) {\n                (sbs[cls.resched] ?? (sbs[cls.resched] = [])).push({...cls, pend: true});\n            }\n        }\n    }\n    return sbs;\n}\n\nfunction reduceSelections(selections) {\n    const sel = new Set();\n    for (const [slot, selected] of Object.entries(selections)) {\n        selected && sel.add(slot);\n    }\n    return sel;\n}\n\nfunction scheduleDiff(inital, current, permResched) {\n    const changes = {};\n    for (const [id, cls] of Object.entries(current)) {\n        if ((cls.resched ?? cls.slot) !== (inital[id].resched ?? inital[id].slot)) {\n            const toSlot = cls.resched ?? cls.slot;\n            if(permResched) {\n                changes[id] = toSlot;\n            } else {\n                for (const { clsId, id: toSlotId } of cls.alts) {\n                    if (toSlot === toSlotId) {\n                        changes[id] = clsId;\n                        break;\n                    }\n                }\n            }\n        }\n    }\n    return changes;\n}\n\nexport function Schedule({ initSchedule, initRatings, initSelections, onSelect, disabledSlots, mode, actions, permResched, setDataPusher, title }) {\n    const dropSlots = React.useRef({});\n    const swipeX = React.useRef(null);\n    const windWith = React.useContext(WidthContext);\n    const registerDropSlot = React.useCallback((slot, cb, unsub) => unsub ? (delete dropSlots.current[slot]) : (dropSlots.current[slot] = cb), []);\n    const borderRef = React.useRef();\n    const [{ schedule, selections, ratings, dragged, shitf: shift }, dispatch] = React.useReducer(schedStateReducer, {\n        schedule: initSchedule,\n        selections: initSelections,\n        ratings: initRatings,\n        dragged: null,\n        shitf: 0,\n        dropSlots,\n        permResched\n    });\n    React.useEffect(() => dispatch({action: \"setSchedule\", data: initSchedule}), [initSchedule]);\n    React.useEffect(() => dispatch({action: \"setSelections\", data: initSelections}), [initSelections]);\n    React.useEffect(() => dispatch({action: \"setRatings\", data: initRatings}), [initRatings]);\n    const schedBySlot = React.useMemo(() => transformSchedule(schedule, permResched, dragged?.disId), [schedule, permResched, dragged]);\n\n    const fwd = {mode, dispatch, registerDropSlot, onSelect, borderRef};\n    const getCbData = {\n        reschedule: () => scheduleDiff(initSchedule, schedule, permResched),\n        select: () => reduceSelections(selections),\n        rate: () => ratings\n    }[mode];\n    React.useEffect(() => setDataPusher?.(getCbData));\n    if (windWith < 700) {\n        if (fwd.mode === \"reschedule\") {\n            fwd.mode = \"reschedule-select\";\n            if (dragged) {\n                fwd.onSelect = function(slot) {\n                    dispatch({action: \"resched\", data: slot})\n                }\n            }\n        }\n        return (\n            <div id=\"schedule\" className=\"content-box\" style={{overflow: \"hidden\", minWidth: 0}}> \n                {title}\n                <div id=\"scheduleborder\" ref={borderRef} onPointerDown={event => swipeX.current = event.clientX} onPointerCancel={() => swipeX.current = null} onPointerUp={function(event) {\n                    if (swipeX.current) {\n                        const len = event.clientX - swipeX.current;\n                        if (len*6 > windWith) {\n                            dispatch({action: \"shift\", data: -1});\n                        } else if (len*(-6) > windWith) {\n                            dispatch({action: \"shift\", data: 1});\n                        }\n                        swipeX.current = null;\n                    }\n                }}>\n                    <HourLegend opacity={shift === 0 ? \"0\" : \"1\"}/>\n                    <div id=\"daylist-box-grad\">\n                    <div className='slide-button' onClick={() => dispatch({action: \"shift\", data: -1})} style={{opacity: shift === 0 ? \"0\" : \"1\"}}>&lt;</div>\n                    <div id=\"daylist-box\" style={{transform: `translateX(-${100*shift}%)`}}>\n                        <ul id=\"daylist\">\n                            {days.map(function(day) {\n                                return (\n                                    <li key={day}><ul className=\"daycolumn\">\n                                        {day}\n                                        {hours.map(function(hour) {\n                                            const slot = getSlotId(day, hour);\n                                            return <ClassBox\n                                                key={slot} \n                                                slot={slot} \n                                                cls={schedBySlot[slot]}\n                                                selected={mode === \"reschedule\" ? (dragged?.drops?.includes(slot) ?? false) : selections?.[slot]}\n                                                rating={ratings?.[slot]}\n                                                droppable={permResched ? \"all\" : dragged?.drops.includes(slot)}\n                                                disabled={disabledSlots?.has(slot)}\n                                                {...fwd}\n                                            />\n                                        })}\n                                    </ul></li>\n                                );\n                            })}\n                        </ul>\n                    </div>\n                    <div className='slide-button' onClick={() => dispatch({action: \"shift\", data: 1})} style={{opacity: shift === 4 ? \"0\" : \"1\"}}>&gt;</div>\n                    </div>\n                    <HourLegend opacity={shift === 4 ? \"0\" : \"1\"}/>\n                </div>\n                {dragged?.elem}\n                {actions?.map((act, i) => <Button key={i} {...(act.btProps ?? {})} onClick={() => act.cb(getCbData())}>{act.name}</Button>)}\n            </div>\n        );\n    }\n    return (\n        <div id=\"schedule\" className=\"content-box\">\n            {title}\n            <div id=\"scheduleborder\" ref={borderRef}>\n                <ul id=\"daylist\">\n                    <li><HourLegend/></li>\n                    {days.map(function(day) {\n                        return (\n                            <li key={day}><ul className=\"daycolumn\">\n                                {day}\n                                {hours.map(function(hour) {\n                                    const slot = getSlotId(day, hour);\n                                    return <ClassBox\n                                        key={slot} \n                                        slot={slot} \n                                        cls={schedBySlot[slot]}\n                                        selected={selections?.[slot]}\n                                        rating={ratings?.[slot]}\n                                        droppable={permResched ? \"all\" : dragged?.drops.includes(slot)}\n                                        disabled={disabledSlots?.has(slot)}\n                                        {...fwd}\n                                    />\n                                })}\n                            </ul></li>\n                        );\n                    })}\n                    <li><HourLegend/></li>\n                </ul>\n            </div>\n            {dragged?.elem}\n            {actions?.map((act, i) => <Button key={i} {...(act.btProps ?? {})} onClick={() => act.cb(getCbData())}>{act.name}</Button>)}\n        </div>\n    );\n}\n\nfunction ScheduleView() {\n    console.log(\"sched view rerenders\");\n    const dispatch = React.useContext(DispatchContext);\n    const [mode, setMode] = React.useState(\"view\");\n    const [{ schedule, hasAlts}, setSchedule] = React.useState({schedule: undefined, hasAlts: false});\n    const [ratings, refreshRts, setRatings] = useRemoteData(fetchRatings, mode === \"rate\");\n    React.useEffect(function() {\n        if (mode === \"reschedule\") {\n            (schedule === undefined || !hasAlts) && fetchClasses(true).then(function(sched) {\n                setSchedule({schedule: sched, hasAlts: true});\n            }, err => dispatch({action: \"error\", data: err}));\n        } else {\n            (schedule === undefined) && fetchClasses().then(sched => setSchedule({schedule: sched, hasAlts: false}), err => dispatch({action: \"error\", data: err}));\n        }\n    }, [schedule, hasAlts, mode, dispatch]);\n    if (!schedule || (mode === \"rate\" && ratings === undefined) || (mode === \"reschedule\" && !hasAlts)) {\n        return <div>Loading content...</div>;\n    }\n    const actions = [];\n    const schedProps = {actions, mode, title: \"Plan Zajęć\"};\n    if (mode === \"reschedule\") {\n        actions.push({\n            name: \"Zaporoponuj zmiany\",\n            cb: function(chng) {\n                setMode(\"view\");\n                setSchedule({schedule: null, hasAlts: false});\n                pushRescheduleRequest(chng).then(() => fetchClasses()).then(sched => setSchedule({schedule: sched, hasAlts: false}), err => dispatch({action: \"error\", data: err}));\n            }\n        });\n    } else if (mode === \"rate\") {\n        actions.push({\n            name: \"Zapisz\",\n            cb: function(rtings) {\n                setMode(\"view\");\n                setRatings(undefined);\n                pushRatings(rtings).then(refreshRts, err => dispatch({action: \"popupError\", data: err}));\n            }\n        });\n        schedProps.initRatings = ratings;\n    }\n    return (\n        <>\n            <Schedule initSchedule={schedule} {...schedProps}/>\n            <div className='buttons-below-sched'>\n                <Button onClick={() => setMode(\"view\")}>Plan</Button>\n                <Button onClick={() => setMode(\"reschedule\")}>Zmiana Grup</Button>\n                <Button onClick={() => setMode(\"rate\")}>Dogodność Godzin</Button>\n            </div>\n        </>\n    )\n}\n\nfunction HourLegend({ opacity }) {\n    const style = {};\n    opacity && (style.opacity = opacity);\n    return (\n        <ul className=\"hourlegend\" style={style}>\n            &nbsp;\n            {[8, 10, 12, 14, 16, 18].map(hour => <li key={hour}>{hour + \":15\"}</li>)}\n        </ul>\n    );\n}\n\nfunction ClassBox({ cls, slot, mode, dispatch, registerDropSlot, selected, onSelect, rating, droppable, disabled, borderRef }) {\n    const ref = React.useRef();\n    const fwd = {mode, dispatch, rating, borderRef};\n    React.useEffect(function() {\n        if (droppable) {\n            registerDropSlot(slot, function(x, y) {\n                const rect = ref.current.getBoundingClientRect();\n                return (y > rect.top && y < rect.bottom && x > rect.left && x < rect.right);\n            }, false);\n            return () => registerDropSlot(slot, null, true);\n        }\n    }, [slot, registerDropSlot, droppable]);\n    let cont = null;\n    if (rating !== undefined) {\n        cont = <Rater {...fwd} slot={slot} cls={cls}/>;\n    } else if (cls !== undefined && cls.length !== 0) {\n        cont = cls.length === 1 ? <Class {...fwd} cls={cls[0]}/> : <Collision {...fwd} cls={cls}/>;\n    }\n    const handlers = {};\n    if ((mode === \"select\" || mode === \"reschedule-select\") && selected !== undefined) {\n        handlers.onClick = function() {\n            mode === \"select\" && dispatch({action: \"toggleSelect\", data: slot});\n            onSelect?.(slot);\n        }\n    }\n    let clsName = \"class-box\";\n    if (droppable === true || selected) {\n        clsName = clsName.concat(disabled ? \" selected-disabled\" : \" highlight\");\n    } else if (disabled) {\n        clsName = clsName.concat(\" disabled-slot\");\n    }\n    return <li className={clsName} {...handlers} ref={ref}>{cont}</li>;\n}\n\nfunction Class(props) {\n    const width = props.width ?? 100;\n    const [{ text, prevW }, setText] = React.useState({prevW: 100});\n    React.useLayoutEffect(function() {\n        let newText;\n        if (width >= 65) {\n            newText = (<>\n                {props.cls.name}<br/>\n                {props.cls.type}<br/>\n                Sala: {props.cls.room}\n            </>);\n        } else if (width > 18) {\n            newText = <>{props.cls.name.split('').map(l => <>{l}<br/></>)}</>;\n        } else {\n            newText = <>I</>;\n        }\n        if (width > prevW) {\n            const tId = setTimeout(() => setText({text: newText, prevW: width}), 100);\n            return () => clearTimeout(tId);\n        }\n        setText({text: newText, prevW: width});\n    }, [width, prevW, props.cls.name, props.cls.type, props.cls.room])\n    let handlers = {};\n    if (props.mode === \"reschedule\") {\n        handlers.onMouseDown = function(event) {\n            event.preventDefault();\n            const rect = event.currentTarget.getBoundingClientRect();\n            const offset = {\n                x: rect.x + window.scrollX - event.pageX,\n                y: rect.y + window.scrollY - event.pageY\n            }\n            props.dispatch?.({action: \"drag\", data: {\n                elem: <DraggedClass cls={props.cls} initPos={{x: event.pageX, y: event.pageY}} offset={offset} dispatch={props.dispatch} borderRef={props.borderRef}/>,\n                drops: props.cls.alts?.map(alt => alt.id),\n                disId: props.cls.id\n            }});\n        }\n    } else if (props.mode === \"reschedule-select\") {\n        handlers.onClick = function() {\n            props.dispatch?.({action: \"drag\", data: {\n                drops: props.cls.alts?.map(alt => alt.id),\n                id: props.cls.id\n            }});\n        }\n    }\n    const style = props.cls.pend ? {opacity: 0.5} : {};\n    return (<div className={props.cls.type} {...handlers} style={style}>{text}</div>);\n}\n\nfunction DraggedClass({ initPos, cls, offset: {x: ox, y: oy}, dispatch, borderRef }) {\n    const ref = React.useRef();\n    const { x, y } = useMousePos(initPos);\n    const { width, height } = ref.current?.getBoundingClientRect() ?? {width: 0, height: 0};\n    const { top: borderTop, left: borderLeft, bottom: borderBottom, right: borderRight } = borderRef.current.getBoundingClientRect();\n    const leftPos = Math.min(Math.max(x + ox, borderLeft + window.scrollX), borderRight + window.scrollX - width);\n    const topPos = Math.min(Math.max(y + oy, borderTop + window.scrollY), borderBottom + window.scrollY - height);\n    return (<div className=\"class-box dragged-class\" style={{\n        left: leftPos,\n        top: topPos\n    }} ref={ref} onMouseUp={function() {\n        const {top, bottom, left, right} = ref.current.getBoundingClientRect();\n        dispatch({action: \"endDrag\", data: {y: (top + bottom) / 2, x: (left + right) / 2, id: cls.id}})\n    }}>\n        <Class cls={cls}/>\n    </div>);\n}\n\nfunction Collision({ cls: clss, mode, dispatch, borderRef }) {\n    const eqWidth = 100/clss.length;\n    const fWidth = 65;\n    const ufWidth = 35/(clss.length - 1);\n    const ref = React.useRef();\n    const [focused, setFocused] = React.useState(null);\n    \n    // onMouseLeave has issues with draggables, so onMouseMove must be used\n    // onMouseLeave is still used, to handle the overflow case in \"rate\" mode\n    React.useEffect(function() {\n        function onMove(event) {\n            const { clientX: mx, clientY: my} = event;\n            const {top, bottom, left, right} = ref.current.getBoundingClientRect();\n            if (my < top || my > bottom || mx < left || mx > right) {\n                setFocused(null);\n            }\n        }\n        window.addEventListener(\"mousemove\", onMove);\n        return () => window.removeEventListener(\"mousemove\", onMove);\n    }, [])\n\n    return (\n        <div ref={ref} style={{height: \"100%\"}} onMouseLeave={() => setFocused(null)}>\n            {clss.map(function(cls, i) {\n                const width = focused === null ? eqWidth : (i === focused ? fWidth : ufWidth);\n                const fwd = {cls, width, mode, dispatch, borderRef};\n                return (\n                    <div key={i} className=\"shrunk-box\" onMouseEnter={() => setFocused(i)} style={{maxWidth: `${width}%`}}>\n                        <Class {...fwd}/>\n                    </div>\n                );\n            })}\n        </div>\n    );\n}\n\nfunction Rater({ dispatch, slot, rating, mode, cls, borderRef }) {\n    const [clsExpanded, setExpanded] = React.useState(false);\n    let cont = null;\n    if (mode !== \"rate\") {\n        cont = <div className='rating' style={{textShadow: `0 0 0.3em ${getColor(rating / 6)}`, width: \"100%\"}}>{rating}</div>;\n    } else {\n        cont = (\n            <>\n                <div className='rating' style={{textShadow: `0 0 0.3em ${getColor(rating / 6)}`}}>{rating}</div>\n                <div className='rater-button-box'>\n                    <div className='rater-button' onClick={() => dispatch({action: \"rerate\", data: {slot, rating: Math.min(6, rating + 1)}})}>+</div>\n                    <div className='rater-button' onClick={() => dispatch({action: \"rerate\", data: {slot, rating: Math.max(0, rating - 1)}})}>-</div>\n                </div>\n            </>\n        )\n    }\n    if (cls) {\n        const fwd = {mode, borderRef, dispatch};\n        const clsElem = cls.length === 1 ? <Class {...fwd} cls={cls[0]}/> : <Collision {...fwd} cls={cls}/>;\n        return (<>\n            <div className='rater' style={{maxHeight: clsExpanded ? \"0\" : \"62%\"}}>\n                {cont}\n            </div>\n            <div style={{height: \"100%\"}} onClick={() => setExpanded(e => !e)} onMouseLeave={() => setExpanded(false)}>\n                {clsElem}\n            </div>\n        </>);\n    }\n    return <div className='rater'>{cont}</div>;\n}\n\nexport function expandSelection(sel) {\n    const fullSel = {};\n    Array.from(Array(30).keys()).forEach(i => {fullSel[i+1] = false});\n    return {...fullSel, ...sel};\n}\n\nexport default ScheduleView;","import React from \"react\"\nimport { Button, DispatchContext } from \"./App\";\nimport \"./Login.css\"\nimport { fetchUser, login } from \"./Remote\";\n\nexport default function LogIn() {\n    const dispatch = React.useContext(DispatchContext);\n    const [nameVal, setName] = React.useState(\"\");\n    const [passVal, setPass] = React.useState(\"\");\n    const [invalidCred, setInvalidCred] = React.useState(false);\n    function onChangeName(event) {\n        setName(event.target.value);\n    }\n    function onChangePass(event) {\n        setPass(event.target.value);\n    }\n    function onSubmit(event) {\n        event.preventDefault();\n        login(nameVal, passVal)\n            .then(fetchUser)\n            .then(function(user) {\n                if (!user) {\n                    setInvalidCred(true);\n                } else {\n                    dispatch({action: \"login\", data: user});\n                }\n            }, err => dispatch({action: \"error\", data: err}));\n    }\n    return (\n        <form onSubmit={onSubmit}>\n            <input type=\"text\" name=\"name\" value={nameVal} onChange={onChangeName} required placeholder=\"Login\"/><br/>\n            <input type=\"password\" name=\"password\" value={passVal} onChange={onChangePass} required placeholder=\"Hasło\"/><br/>\n            <Button submit>Log in</Button>\n            {invalidCred && <div className=\"invalid-cred\">\n                Invalid credentials\n            </div>}\n        </form>\n    );\n}\n\nexport function LogInLink({ user }) {\n    const dispatch = React.useContext(DispatchContext);\n    if (user) {\n        return (\n            <span style={{float: \"right\"}} onClick={() => dispatch({action: \"logout\"})}>Log out</span>\n        )\n    }\n    return (\n        <span style={{float: \"right\"}} onClick={function() {\n            dispatch({action: \"setContent\", data: <LogIn/>});\n        }}>Log in</span>\n    )\n}","import React from 'react';\nimport { DispatchContext } from \"./App\";\nimport { LogInLink } from './Login';\nimport './Nav.css';\n\n\nexport function NavLink({ children, view, nNots }) {\n    const dispatch = React.useContext(DispatchContext);\n    return (<span onClick={() => dispatch({action: \"setContent\", data: view})}>\n        {children}\n        {nNots && <div className=\"notifIndicator\">{nNots}</div>}\n    </span>);\n}\n\nexport default function NavBar({ links, windWidth, user }) {\n    const [sideVisible, setSide] = React.useState(false);\n    const prompt = <div className='info-text'>You must be logged in to view this content</div>;\n    if (windWidth < 900) {\n        return (\n            <nav className=\"small-nav\">\n                <div style={{transform: `translateX(-${sideVisible ? 0 : 100}%)`}} onClick={() => setSide(false)}>\n                    {links.map((link, i) => <NavLink key={i} view={user ? link.view : prompt} stack={true} nNots={link.nNots}>{link.name}</NavLink>)}\n                </div>\n                <span onClick={() => setSide(prev => !prev)}>Menu</span>\n                <LogInLink user={user}/>\n            </nav>\n        );    \n    }\n    return (\n        <nav>\n            <LogInLink user={user}/>\n            {links.map((link, i) => <NavLink key={i} view={user ? link.view : prompt} stack={false} nNots={link.nNots}>{link.name}</NavLink>)}\n        </nav>\n    );\n}\n","import React from \"react\";\nimport { NavLink } from \"./Nav\";\nimport './Courses.css';\nimport { fetchCourses, useRemoteData } from \"./Remote\";\n\nfunction getCourseText(name) {\n    return `blablabla info o ${name}`;\n}\n\nfunction CourseInfo(props) {\n    const [info, setInfo] = React.useState(\"\");\n    React.useEffect(function() {\n        setInfo(getCourseText(props.name));\n    }, [props.name]);\n    return (\n        <div>\n            <h2>{props.name}</h2>\n            {info}\n        </div>\n    )\n}\n\nfunction MaitainerInfo(props) {\n    const [info, setInfo] = React.useState(\"\");\n    React.useEffect(function() {\n        setInfo(getCourseText(props.name));\n    }, [props.name]);\n    return (\n        <div>\n            {info}\n        </div>\n    )\n}\n\nfunction CoursesList() {\n    const [courses] = useRemoteData(fetchCourses);\n    if (courses === undefined) {\n        return <div>Loading content...</div>;\n    }\n    return (\n        <div id=\"courses\" className=\"content-box\">\n            Moje Przedmioty\n            {courses.map(crs => <Course key={crs.id} name={crs.name}/>)}\n        </div>\n    )\n}\n\nfunction Course(props) {\n    const [expanded, setExpanded] = React.useState(false);\n    return (\n        <>\n            <div className=\"course\" onClick={function() {\n                setExpanded(prev => !prev);\n            }}>{props.name}</div>\n            <div className=\"course-menu\" style={{maxHeight: expanded ? \"3em\" : \"0\"}}>\n                <NavLink view={<CourseInfo name={props.name}/>}>Strona przedmiotu</NavLink>\n                <NavLink view={<MaitainerInfo name={props.maitainerName}/>}>Strona prowadzącego</NavLink>\n            </div>\n        </>\n    )\n}\n\nexport default CoursesList;","import React from 'react';\r\nimport { useRemoteData, fetchGrades } from \"./Remote\";\r\nimport './Grades.css';\r\n\r\nexport default function Grades() {\r\n    const [courses] = useRemoteData(fetchGrades);\r\n    if (courses === undefined) {\r\n        return <div>Loading grades...</div>;\r\n    }\r\n    return (\r\n        <div className='content-box'>\r\n            Moje oceny\r\n            {courses.map(crs => <div className='box-row'><div>{crs.name}:</div><div className='grade'>{crs.grade}</div></div>)}\r\n        </div>\r\n    );\r\n}","import React from 'react';\r\nimport { Button, DispatchContext } from './App';\r\nimport { fetchRequests, useRemoteData, approveRequest, declineRequest } from \"./Remote\";\r\nimport './ReschedRequests.css';\r\nimport { getSlotName } from './Schedule';\r\n\r\nexport default function ReschedRequests() {\r\n    const [requests, _, setRequests] = useRemoteData(fetchRequests);\r\n    const delRequest = React.useCallback(function(id) {\r\n        setRequests(reqs => reqs.filter(r => r.id !== id));\r\n    }, [setRequests])\r\n    if (requests === undefined) {\r\n        return <div>Loading requests...</div>;\r\n    }\r\n    return (\r\n        <div className=\"content-box\">\r\n            Prośby o zmiany grup\r\n            {requests.map(req => <RRequest key={req.id} {...req} del={delRequest}/>)}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction RRequest({ id, stud, cls, to, del }) {\r\n    const [pending, setPending] = React.useState(false);\r\n    const dispatch = React.useContext(DispatchContext);\r\n    return (\r\n        <div className=\"box-row\">\r\n            <div className='request-text'>\r\n                {cls.name} {cls.type},<br/>\r\n                {stud},<br/>\r\n                na {getSlotName(to)}\r\n            </div>\r\n            <div className='request-buttons'>\r\n                {pending ? <div className='request-text'>przetwarzanie...</div> : (<><Button onClick={function() {\r\n                    setPending(true);\r\n                    approveRequest(id).then(() => del(id), function(err) {\r\n                        setPending(false);\r\n                        dispatch({action: \"popupError\", data: err});\r\n                    });\r\n                }}>Zaakceptuj</Button>\r\n                <Button onClick={function() {\r\n                    setPending(true);\r\n                    declineRequest(id).then(() => del(id), function(err) {\r\n                        setPending(false);\r\n                        dispatch({action: \"popupError\", data: err});\r\n                    });\r\n                }}>Odrzuć</Button></>)}\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\nimport { Button, DispatchContext, GroupSelector, usePopup, verifyClose } from \"./App\";\r\nimport { fetchPolls, useRemoteData, removePoll, resolvePoll, votePoll, fetchPollSlots, fetchIntersect, addPoll } from \"./Remote\";\r\nimport { expandSelection, Schedule } from './Schedule';\r\n\r\nexport default function Polls({ user }) {\r\n    const dispatch = React.useContext(DispatchContext);\r\n    const stud = user.position === \"ROLE_STUDENT\";\r\n    const [polls, _, setPolls] = useRemoteData(fetchPolls);\r\n    const [popup, show] = usePopup();\r\n    const resolve = React.useCallback(function resolve(id) {\r\n        resolvePoll(id).then(function(res) {\r\n            const best = Object.entries(res).reduce((s1, s2) => s1[1] > s2[1] ? s1 : s2)[0]\r\n            return show(() => <Schedule\r\n                title=\"Wynik ankiety\"\r\n                initRatings={res}\r\n                initSelections={{[best]: true}}\r\n                mode=\"view\"\r\n            />)\r\n        }).catch(verifyClose).catch(err => dispatch({action: \"popupError\", data: err}));\r\n    }, [show, dispatch]);\r\n    const vote = React.useCallback(function(id) {\r\n        fetchPollSlots(id).then(slots => show(handleData => <Schedule\r\n            initRatings={slots}\r\n            mode=\"rate\"\r\n            actions={[{\r\n                name: \"Głosuj\",\r\n                cb: handleData\r\n            }]}/>\r\n        )).then(rtngs => votePoll(id, rtngs), verifyClose)\r\n            .catch(err => dispatch({action: \"popupError\", data: err}));\r\n    }, [show, dispatch]);\r\n    const add = React.useCallback(function() {\r\n        show(h => <GroupSelector onSelect={h}/>)\r\n            .then(async function(grps) {\r\n                const slots = await fetchIntersect(grps);\r\n                const { name, slots: newSlots } = await show(h => <SlotSelector onSelect={h} initSlots={slots}/>).catch(verifyClose);\r\n                return await addPoll(name, newSlots, grps);\r\n            })\r\n            .then(newPoll => setPolls(pls => [...pls, newPoll]), err => dispatch({action: \"popupError\", data: err}));\r\n    }, [show, setPolls, dispatch]);\r\n    const remove = React.useCallback(function(id) {\r\n        removePoll(id).then(() => setPolls(pls => pls.filter(p => p.id !== id)), err => dispatch({action: \"popupError\", data: err}));\r\n    }, [setPolls, dispatch]);\r\n    if (polls === undefined) {\r\n        return <div>Loading polls...</div>;\r\n    }\r\n    return (\r\n        <>\r\n            <div className=\"content-box\">\r\n                Ankiety\r\n                {polls.map(poll => <Poll key={poll.id} {...poll} resolve={resolve} remove={remove} vote={stud ? vote : null}/>)}\r\n            </div>\r\n            {stud || <div><Button onClick={add}>Dodaj</Button></div>}\r\n            {popup}\r\n        </>\r\n    );\r\n}\r\n\r\nfunction Poll({ id, name, voted, resolve, remove, vote }) {\r\n    return (\r\n        <div className=\"box-row\">\r\n            <div>{name}</div>\r\n            <div>\r\n                {vote ? <>{voted && \"Zagłosowano\"}<Button onClick={() => vote(id)}>Głosuj</Button></> :\r\n                <><Button onClick={() => resolve(id)}>Wynik</Button>\r\n                <Button onClick={() => remove(id)}>Zakończ</Button></>}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction SlotSelector({ onSelect, initSlots }) {\r\n    const crtBtRef = React.useRef();\r\n    const [expandedSlots, disabled] = React.useMemo(function() {\r\n        const expSelect = expandSelection(initSlots);\r\n        const disabled = new Set();\r\n        Object.keys(expSelect).forEach(slot => slot in initSlots || disabled.add(slot));\r\n        return [expSelect, disabled];\r\n    }, [initSlots]);\r\n    const schedDataGetter = React.useRef(null);\r\n    const [name, setName] = React.useState(\"\");\r\n    return (\r\n        <>  \r\n            <div style={{marginBottom: \"0.5em\"}}>\r\n                <form id=\"slot-selector-form\" className=\"search-bar\" onSubmit={function(event) {\r\n                    event.preventDefault();\r\n                    onSelect({name, slots: schedDataGetter.current()});\r\n                }}>\r\n                    <div>\r\n                        <input \r\n                            type=\"text\"\r\n                            value={name}\r\n                            onChange={event => setName(event.target.value)}\r\n                            required\r\n                            placeholder=\"Wpisz nazwę\"\r\n                        />\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            <div onClick={() => crtBtRef.current?.focus({preventScroll: true})}>\r\n                <Schedule\r\n                    initSelections={expandedSlots}\r\n                    disabledSlots={disabled}\r\n                    mode=\"select\"\r\n                    setDataPusher={getter => () => schedDataGetter.current = getter}\r\n                />\r\n            </div>\r\n            <div>\r\n                <Button ref={crtBtRef} form=\"slot-selector-form\" submit>Utwórz</Button>\r\n            </div>\r\n        </>\r\n    );\r\n}","import { fetchNews, useRemoteData } from \"./Remote\";\r\nimport './News.css';\r\n\r\nexport default function News() {\r\n    const [infos] = useRemoteData(fetchNews);\r\n    if (infos === undefined) {\r\n        return <div>Loading news...</div>\r\n    }\r\n    return (\r\n        <div className=\"content-box\" id=\"news-box\">\r\n            Aktualności\r\n            {infos.map(info => <div className=\"box-row\"><div style={{display: \"block\"}}>\r\n                    <h3>{info.title}</h3>\r\n                    <div className=\"info-box\">\r\n                        {info.text}\r\n                    </div>\r\n                </div>\r\n            </div>)}\r\n        </div>\r\n    );\r\n}","import React from \"react\"\r\nimport { Button, DispatchContext, SearchBar } from \"./App\";\r\nimport { fetchWorkerInfo, fetchWorkers, useRemoteData } from \"./Remote\";\r\n\r\nexport default function Workers() {\r\n    const dispatch = React.useContext(DispatchContext);\r\n    const [workers] = useRemoteData(fetchWorkers);\r\n    const suggestions = React.useMemo(() => workers?.map(w => w.name), [workers]);\r\n    const [searched, setSearched] = React.useState(null);\r\n    const [worker, setWorker] = React.useState(null);\r\n    if (workers === undefined) {\r\n        return <div>Loading workers...</div>;\r\n    }\r\n    return (\r\n        <div className=\"content-box\">\r\n            Pracownicy\r\n            <SearchBar onSearch={function(str) {\r\n                setWorker(null);\r\n                setSearched(workers.filter(w => w.name.includes(str)));\r\n            }} suggestions={suggestions}/>\r\n            {worker?.text ?? searched?.map(w => <div key={w.id} className=\"content-row\">{w.name}<Button onClick={function() {\r\n                fetchWorkerInfo(w.id).then(setWorker, err => dispatch({action: \"error\", data: err}));\r\n            }}>Wybierz</Button></div>)}\r\n        </div>\r\n    )\r\n}","import React from 'react';\r\nimport { DispatchContext, GroupSelector } from \"./App\";\r\nimport { fetchGroupSchedule, pushRescheduleRequest } from './Remote';\r\nimport { Schedule } from \"./Schedule\";\r\n\r\nexport default function AdminSchedule() {\r\n    const dispatch = React.useContext(DispatchContext);\r\n    const [filteredClasses, setClasses] = React.useState(null);\r\n    const [groups, setGroups] = React.useState(null);\r\n    React.useEffect(() => groups === null || fetchGroupSchedule(groups).then(setClasses), [groups])\r\n    return (\r\n        <>\r\n            <div className=\"content-box\">\r\n                <GroupSelector onSelect={setGroups}/>\r\n            </div><br/>\r\n            {filteredClasses && <Schedule \r\n                initSchedule={filteredClasses}\r\n                permResched\r\n                mode={\"reschedule\"}\r\n                actions={[{\r\n                    name: \"Zmień\",\r\n                    cb: function(chng) {\r\n                        setClasses(null);\r\n                        pushRescheduleRequest(chng)\r\n                            .then(() => fetchGroupSchedule(groups))\r\n                            .then(setClasses, err => dispatch({action: \"error\", data: err}));\r\n                    }\r\n                }]}\r\n            />}\r\n        </>\r\n    )\r\n}","import React from 'react';\nimport ScheduleView from './Schedule';\nimport LogIn from './Login';\nimport NavBar from './Nav';\nimport CoursesList from './Courses';\nimport './App.css';\nimport Grades from './Grades';\nimport ReschedRequests from './ReschedRequests';\nimport Register from './Register';\nimport Polls from './Polls';\nimport News from './News';\nimport Workers from './Workers';\nimport { fetchGroups, fetchUser, useRemoteData } from './Remote';\nimport AdminSchedule from './AdminSchedule';\n\nexport const DispatchContext = React.createContext();\nexport const WidthContext = React.createContext();\n\nfunction stateReducer(state, { action, data }) {\n    switch (action) {\n        case \"resize\":\n            return {...state, width: window.innerWidth};\n        case \"login\":\n            return {...state, user: data, content: <News/>};\n        case \"logout\":\n            return {...state, user: null, content: <LogIn/>};\n        case \"setContent\":\n            return {...state, content: data};\n        case \"error\":\n            return {...state, content: <div className='info-text'>{data.message}</div>}\n        case \"popupError\":\n            return {...state, popup: <div className='info-text'>{data.message}</div>}\n        case \"closePopup\":\n            return {...state, popup: null}\n        case \"setUser\":\n            return {...state, user: data};\n        default:\n            return state;\n    }\n}\n\nexport default function App() {\n    const [{ content, user, width, popup }, dispatch] = React.useReducer(stateReducer, {\n        content: null,\n        user: undefined,\n        width: window.innerWidth,\n        popup: null\n    });\n    React.useEffect(function() {\n        const updateWidth = () => dispatch({action: \"resize\"});\n        window.addEventListener(\"resize\", updateWidth);     \n        return () => window.removeEventListener(\"resize\", updateWidth);\n    }, []);\n    React.useEffect(function() {\n        if (user === undefined) {\n            dispatch({action: \"setUser\", data: null});\n            fetchUser()\n                .then(user => dispatch(user === false ? {action: \"setContent\", data: <LogIn/>} : {action: \"login\", data: user}))\n                .catch(err => dispatch({action: \"error\", data: err}));\n        }\n    }, [user])\n    React.useEffect(function() {\n        // const intt = setInterval(() => console.log(document.activeElement), 500);\n        // return () => clearInterval(intt);\n        const logevent = event => console.log(event);\n        window.addEventListener(\"pointerdown\", logevent);\n        window.addEventListener(\"pointerup\", logevent);\n        window.addEventListener(\"pointercancel\", logevent);\n    }, []);\n\n    const links = [\n        {name: \"Plan zajęć\", view: <ScheduleView/>},\n        {name: \"Ankiety\", view: <Polls user={user}/>, nNots: user ? 10 : undefined},\n        {name: \"Aktualności\", view: <News/>},\n        {name: \"Pracownicy\", view: <Workers/>},\n    ];\n    const showAll = true;\n    if (user) {\n        if (user.position === \"ROLE_STUDENT\" || showAll) {\n        links.push(...[\n            {name: \"Oceny\", view: <Grades/>},\n            {name: \"Przedmioty\", view: <CoursesList/>},\n            {name: \"Rejestracja\", view: <Register/>},\n        ]);\n        } else {\n            links.push({name: \"Zmiany grup\", view: <ReschedRequests/>, nNots: user ? 3 : undefined});\n        }\n        if (showAll) {\n            links.push({name: \"Zmiany grup\", view: <ReschedRequests/>, nNots: user ? 3 : undefined});\n        }\n        if (user.security === \"ROLE_ADMIN\" || showAll) {\n            links.push({name: \"Plan\", view: <AdminSchedule/>});\n        }\n    }\n    return (\n        <WidthContext.Provider value={width}>\n        <DispatchContext.Provider value={dispatch}>\n            <NavBar links={links} windWidth={width} user={user}/>\n            <ContentBox>\n                {user === undefined ? <div>Loading...</div> : content}\n            </ContentBox>\n            {popup && <Popup close={() => dispatch({action: \"closePopup\"})}>{popup}</Popup>}\n            <Footer/>\n        </DispatchContext.Provider>\n        </WidthContext.Provider>\n    );\n}\n\nfunction ContentBox({ children }) {\n    return (\n        <div id=\"content\">\n            <div>\n                {children}\n            </div>\n        </div>\n    );\n}\n\nexport const Button = React.forwardRef(function({ onClick, children, submit, style, autofocus, form }, ref) {\n    const [clicked, setClicked] = React.useState(false);\n    React.useEffect(() => autofocus && ref.current.focus({preventScroll: true}), []);\n    return (\n        <button \n            className={\"button\" + (clicked ? \" button-clicked\" : \"\")} \n            onClick={onClick}\n            onMouseDown={() => setClicked(true)}\n            onMouseUp={() => setClicked(false)}\n            onMouseLeave={() => setClicked(false)}\n            type={submit ? \"submit\" : \"\"}\n            style={style}\n            ref={ref}\n            {...(form ? {form} : {})}\n        >\n            <div className=\"bdummy\">{children}</div>\n            <div className={\"btext\"  + (clicked ? \" btext-clicked\" : \"\")}>{children}</div>\n        </button>\n    )\n})\n\nexport function SearchBar({ onSearch, suggestions, searchOnSelect }) {\n    const [searchVal, setVal] = React.useState(\"\");\n    const [focused, setFocused] = React.useState(false);\n    const [focusedSugg, setFocusedSugg] = React.useState(null);\n    const [showSugg, setShowSugg] = React.useState(true);\n    const fltrSuggerstions = React.useMemo(() => suggestions\n        ?.filter(sug => sug.includes(searchVal)),\n    [suggestions, searchVal])\n    return (\n        <form onSubmit={function(event) {\n            event.preventDefault();\n            onSearch(searchVal);\n        }} autoComplete='off'>\n            <div  className=\"search-bar\">\n                <input\n                    type=\"text\"\n                    name=\"name\"\n                    value={searchVal}\n                    onChange={function(event) {\n                        setFocusedSugg(null);\n                        setVal(event.target.value);\n                        setShowSugg(true);\n                    }}\n                    onFocus={() => setFocused(true)}\n                    onBlur={() => setFocused(false)}\n                    onKeyDown={function(event) {\n                        // eslint-disable-next-line default-case\n                        switch(event.key) {\n                            case \"ArrowDown\":\n                                setFocusedSugg(i => Math.min((i ?? -1) + 1, fltrSuggerstions.length - 1));\n                                break;\n                            case \"ArrowUp\":\n                                setFocusedSugg(i => i === null || i === 0 ? null : i - 1);\n                                break;\n                            case \"Enter\":\n                                if (focusedSugg !== null) {\n                                    event.preventDefault();\n                                    const sug = fltrSuggerstions[focusedSugg];\n                                    setVal(sug);\n                                    setFocusedSugg(null);\n                                    setShowSugg(false);\n                                    searchOnSelect && onSearch(sug);\n                                }\n                        }\n                    }}\n                    required\n                    placeholder=\"Szukaj po nazwie\"\n                />\n                {focused && fltrSuggerstions && showSugg && (\n                    <div className=\"suggestions\">\n                        {fltrSuggerstions.map((sug, i) => <div key={i}\n                            className={\"suggestion\" + (i === focusedSugg ? \" focused-sugg\" : \"\")}\n                            onMouseDown={function() {\n                                setVal(sug);\n                                setFocusedSugg(null);\n                                setShowSugg(false);\n                                searchOnSelect && onSearch(sug);\n                            }}\n                        >{sug}</div>)}\n                    </div>\n                )}\n            </div>\n            <Button submit>Szukaj</Button>\n        </form>\n    );\n}\n\nfunction Footer() {\n    return (\n        <div id=\"footer\">\n            Studia 4 PAP-Z223\n        </div>\n    );\n}\n\nfunction Popup({ children, close }) {\n    return (\n        <div className='pop-up-container' onClick={event => event.target === event.currentTarget && close()}>\n            <div className='pop-up'>\n                <div className='button-div'>\n                    <Button onClick={close}>X</Button>\n                </div>\n                {children}\n            </div>\n        </div>\n    )\n}\n\nexport function usePopup() {\n    const rejector = React.useRef(null);\n    const [currElem, setElem] = React.useState(null);\n    React.useEffect(() => () => rejector.current?.(\"popup closed\"), []);\n    const show = React.useCallback(function(elemGetter) {\n        return new Promise(function(resolve, reject) {\n            rejector.current = reject;\n            function close() {\n                setElem(null);\n                reject(\"popup closed\");\n            }\n            setElem(<Popup close={close}>{elemGetter(function(data) {\n                setElem(null);\n                resolve(data);\n            })}</Popup>);\n        })\n    }, [])\n    return [currElem, show];\n}\n\nexport function GroupSelector({ onSelect }) {\n    const buttonRef = React.useRef();\n    const [allGroups] = useRemoteData(fetchGroups);\n    const [groups, setGroups] = React.useState([]);\n    const groupNames = React.useMemo(() => allGroups?.map(gr => gr.name), [allGroups]);\n    if (allGroups === undefined) {\n        return <div>Loading...</div>;\n    }\n    return (\n        <div className='group-selector'>\n            <SearchBar searchOnSelect onSearch={function(searchVal) {\n                const newGroups = [];\n                allGroups.forEach(function(grp) {\n                    if (grp.name.includes(searchVal)) {\n                        groups.includes(grp) || newGroups.push(grp);\n                    }\n                });\n                setGroups(g => [...g, ...newGroups]);\n                buttonRef.current?.focus({preventScroll: true});\n            }} suggestions={groupNames}/>\n            {groups.map(grp => <div key={grp.id}>{grp.name}<Button onClick={function() {\n                setGroups(function(g) {\n                    const cp = [...g];\n                    cp.splice(g.indexOf(grp), 1)\n                    return cp;\n                });\n            }}>X</Button></div>)}\n            {groups.length === 0 || <Button onClick={() => onSelect(groups)} ref={buttonRef} autofocus>Wybierz</Button>}\n        </div>\n    )\n}\n\nexport function verifyClose(err) {\n    if (err !== \"popup closed\") {\n        throw err;\n    }\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}